from collections import Counter
import numpy as np
from pathlib import Path

from scripts.coordinates_nondimensionalization import normalize_coordinates, shift_coordinates
from scripts.db.xyz_to_db import parse_xyz
from scripts.operations.lattice_microoperations import get_lattice_vectors2
from scripts.operations.spectrum_operations import create_all_spectrum_plots, plot_spectra
from scripts.operations.spectrum_operations import kde_array

# Нормализовать (шаблон)
# data_dict = {}
# for i in range(len(a)):
#     data_dict[i + 1] = a[i]
# shifted_data = shift_coordinates(data_dict.values())
# normalized_data = normalize_coordinates(shifted_data)
# print(normalized_data)
# res = get_lattice_vectors2(normalized_data)

# Нормализовать
# a = parse_xyz(Path("../../data/NaCl/NaCl_7x7x7.xyz"))
# data_dict = {}
# for i in range(len(a)):
#     data_dict[i + 1] = a[i]
# shifted_data = shift_coordinates(data_dict.values())
# normalized_data = normalize_coordinates(shifted_data)
# print(normalized_data)
# res = get_lattice_vectors2(normalized_data)

# Создание графиков по набору векторов
# # 3x3x3
# #a = [['Cl', 0.0, 0.0, 0.0], ['Na', 0.0, 0.0, 0.5], ['Cl', 0.0, 0.0, 1.0], ['Na', 0.0, 0.5, 0.0], ['Cl', 0.0, 0.5, 0.5], ['Na', 0.0, 0.5, 1.0], ['Cl', 0.0, 1.0, 0.0], ['Na', 0.0, 1.0, 0.5], ['Cl', 0.0, 1.0, 1.0], ['Na', 0.5, 0.0, 0.0], ['Cl', 0.5, 0.0, 0.5], ['Na', 0.5, 0.0, 1.0], ['Cl', 0.5, 0.5, 0.0], ['Na', 0.5, 0.5, 0.5], ['Cl', 0.5, 0.5, 1.0], ['Na', 0.5, 1.0, 0.0], ['Cl', 0.5, 1.0, 0.5], ['Na', 0.5, 1.0, 1.0], ['Cl', 1.0, 0.0, 0.0], ['Na', 1.0, 0.0, 0.5], ['Cl', 1.0, 0.0, 1.0], ['Na', 1.0, 0.5, 0.0], ['Cl', 1.0, 0.5, 0.5], ['Na', 1.0, 0.5, 1.0], ['Cl', 1.0, 1.0, 0.0], ['Na', 1.0, 1.0, 0.5], ['Cl', 1.0, 1.0, 1.0]]
# #substance_id = 333
# # 7x7x7
a = [['Cl', 0.0, 0.0, 0.0], ['Na', 0.0, 0.0, 0.16666666666666666], ['Cl', 0.0, 0.0, 0.3333333333333333], ['Na', 0.0, 0.0, 0.5], ['Cl', 0.0, 0.0, 0.6666666666666666], ['Na', 0.0, 0.0, 0.8333333333333334], ['Cl', 0.0, 0.0, 1.0], ['Na', 0.0, 0.16666666666666666, 0.0], ['Cl', 0.0, 0.16666666666666666, 0.16666666666666666], ['Na', 0.0, 0.16666666666666666, 0.3333333333333333], ['Cl', 0.0, 0.16666666666666666, 0.5], ['Na', 0.0, 0.16666666666666666, 0.6666666666666666], ['Cl', 0.0, 0.16666666666666666, 0.8333333333333334], ['Na', 0.0, 0.16666666666666666, 1.0], ['Cl', 0.0, 0.3333333333333333, 0.0], ['Na', 0.0, 0.3333333333333333, 0.16666666666666666], ['Cl', 0.0, 0.3333333333333333, 0.3333333333333333], ['Na', 0.0, 0.3333333333333333, 0.5], ['Cl', 0.0, 0.3333333333333333, 0.6666666666666666], ['Na', 0.0, 0.3333333333333333, 0.8333333333333334], ['Cl', 0.0, 0.3333333333333333, 1.0], ['Na', 0.0, 0.5, 0.0], ['Cl', 0.0, 0.5, 0.16666666666666666], ['Na', 0.0, 0.5, 0.3333333333333333], ['Cl', 0.0, 0.5, 0.5], ['Na', 0.0, 0.5, 0.6666666666666666], ['Cl', 0.0, 0.5, 0.8333333333333334], ['Na', 0.0, 0.5, 1.0], ['Cl', 0.0, 0.6666666666666666, 0.0], ['Na', 0.0, 0.6666666666666666, 0.16666666666666666], ['Cl', 0.0, 0.6666666666666666, 0.3333333333333333], ['Na', 0.0, 0.6666666666666666, 0.5], ['Cl', 0.0, 0.6666666666666666, 0.6666666666666666], ['Na', 0.0, 0.6666666666666666, 0.8333333333333334], ['Cl', 0.0, 0.6666666666666666, 1.0], ['Na', 0.0, 0.8333333333333334, 0.0], ['Cl', 0.0, 0.8333333333333334, 0.16666666666666666], ['Na', 0.0, 0.8333333333333334, 0.3333333333333333], ['Cl', 0.0, 0.8333333333333334, 0.5], ['Na', 0.0, 0.8333333333333334, 0.6666666666666666], ['Cl', 0.0, 0.8333333333333334, 0.8333333333333334], ['Na', 0.0, 0.8333333333333334, 1.0], ['Cl', 0.0, 1.0, 0.0], ['Na', 0.0, 1.0, 0.16666666666666666], ['Cl', 0.0, 1.0, 0.3333333333333333], ['Na', 0.0, 1.0, 0.5], ['Cl', 0.0, 1.0, 0.6666666666666666], ['Na', 0.0, 1.0, 0.8333333333333334], ['Cl', 0.0, 1.0, 1.0], ['Na', 0.16666666666666666, 0.0, 0.0], ['Cl', 0.16666666666666666, 0.0, 0.16666666666666666], ['Na', 0.16666666666666666, 0.0, 0.3333333333333333], ['Cl', 0.16666666666666666, 0.0, 0.5], ['Na', 0.16666666666666666, 0.0, 0.6666666666666666], ['Cl', 0.16666666666666666, 0.0, 0.8333333333333334], ['Na', 0.16666666666666666, 0.0, 1.0], ['Cl', 0.16666666666666666, 0.16666666666666666, 0.0], ['Na', 0.16666666666666666, 0.16666666666666666, 0.16666666666666666], ['Cl', 0.16666666666666666, 0.16666666666666666, 0.3333333333333333], ['Na', 0.16666666666666666, 0.16666666666666666, 0.5], ['Cl', 0.16666666666666666, 0.16666666666666666, 0.6666666666666666], ['Na', 0.16666666666666666, 0.16666666666666666, 0.8333333333333334], ['Cl', 0.16666666666666666, 0.16666666666666666, 1.0], ['Na', 0.16666666666666666, 0.3333333333333333, 0.0], ['Cl', 0.16666666666666666, 0.3333333333333333, 0.16666666666666666], ['Na', 0.16666666666666666, 0.3333333333333333, 0.3333333333333333], ['Cl', 0.16666666666666666, 0.3333333333333333, 0.5], ['Na', 0.16666666666666666, 0.3333333333333333, 0.6666666666666666], ['Cl', 0.16666666666666666, 0.3333333333333333, 0.8333333333333334], ['Na', 0.16666666666666666, 0.3333333333333333, 1.0], ['Cl', 0.16666666666666666, 0.5, 0.0], ['Na', 0.16666666666666666, 0.5, 0.16666666666666666], ['Cl', 0.16666666666666666, 0.5, 0.3333333333333333], ['Na', 0.16666666666666666, 0.5, 0.5], ['Cl', 0.16666666666666666, 0.5, 0.6666666666666666], ['Na', 0.16666666666666666, 0.5, 0.8333333333333334], ['Cl', 0.16666666666666666, 0.5, 1.0], ['Na', 0.16666666666666666, 0.6666666666666666, 0.0], ['Cl', 0.16666666666666666, 0.6666666666666666, 0.16666666666666666], ['Na', 0.16666666666666666, 0.6666666666666666, 0.3333333333333333], ['Cl', 0.16666666666666666, 0.6666666666666666, 0.5], ['Na', 0.16666666666666666, 0.6666666666666666, 0.6666666666666666], ['Cl', 0.16666666666666666, 0.6666666666666666, 0.8333333333333334], ['Na', 0.16666666666666666, 0.6666666666666666, 1.0], ['Cl', 0.16666666666666666, 0.8333333333333334, 0.0], ['Na', 0.16666666666666666, 0.8333333333333334, 0.16666666666666666], ['Cl', 0.16666666666666666, 0.8333333333333334, 0.3333333333333333], ['Na', 0.16666666666666666, 0.8333333333333334, 0.5], ['Cl', 0.16666666666666666, 0.8333333333333334, 0.6666666666666666], ['Na', 0.16666666666666666, 0.8333333333333334, 0.8333333333333334], ['Cl', 0.16666666666666666, 0.8333333333333334, 1.0], ['Na', 0.16666666666666666, 1.0, 0.0], ['Cl', 0.16666666666666666, 1.0, 0.16666666666666666], ['Na', 0.16666666666666666, 1.0, 0.3333333333333333], ['Cl', 0.16666666666666666, 1.0, 0.5], ['Na', 0.16666666666666666, 1.0, 0.6666666666666666], ['Cl', 0.16666666666666666, 1.0, 0.8333333333333334], ['Na', 0.16666666666666666, 1.0, 1.0], ['Cl', 0.3333333333333333, 0.0, 0.0], ['Na', 0.3333333333333333, 0.0, 0.16666666666666666], ['Cl', 0.3333333333333333, 0.0, 0.3333333333333333], ['Na', 0.3333333333333333, 0.0, 0.5], ['Cl', 0.3333333333333333, 0.0, 0.6666666666666666], ['Na', 0.3333333333333333, 0.0, 0.8333333333333334], ['Cl', 0.3333333333333333, 0.0, 1.0], ['Na', 0.3333333333333333, 0.16666666666666666, 0.0], ['Cl', 0.3333333333333333, 0.16666666666666666, 0.16666666666666666], ['Na', 0.3333333333333333, 0.16666666666666666, 0.3333333333333333], ['Cl', 0.3333333333333333, 0.16666666666666666, 0.5], ['Na', 0.3333333333333333, 0.16666666666666666, 0.6666666666666666], ['Cl', 0.3333333333333333, 0.16666666666666666, 0.8333333333333334], ['Na', 0.3333333333333333, 0.16666666666666666, 1.0], ['Cl', 0.3333333333333333, 0.3333333333333333, 0.0], ['Na', 0.3333333333333333, 0.3333333333333333, 0.16666666666666666], ['Cl', 0.3333333333333333, 0.3333333333333333, 0.3333333333333333], ['Na', 0.3333333333333333, 0.3333333333333333, 0.5], ['Cl', 0.3333333333333333, 0.3333333333333333, 0.6666666666666666], ['Na', 0.3333333333333333, 0.3333333333333333, 0.8333333333333334], ['Cl', 0.3333333333333333, 0.3333333333333333, 1.0], ['Na', 0.3333333333333333, 0.5, 0.0], ['Cl', 0.3333333333333333, 0.5, 0.16666666666666666], ['Na', 0.3333333333333333, 0.5, 0.3333333333333333], ['Cl', 0.3333333333333333, 0.5, 0.5], ['Na', 0.3333333333333333, 0.5, 0.6666666666666666], ['Cl', 0.3333333333333333, 0.5, 0.8333333333333334], ['Na', 0.3333333333333333, 0.5, 1.0], ['Cl', 0.3333333333333333, 0.6666666666666666, 0.0], ['Na', 0.3333333333333333, 0.6666666666666666, 0.16666666666666666], ['Cl', 0.3333333333333333, 0.6666666666666666, 0.3333333333333333], ['Na', 0.3333333333333333, 0.6666666666666666, 0.5], ['Cl', 0.3333333333333333, 0.6666666666666666, 0.6666666666666666], ['Na', 0.3333333333333333, 0.6666666666666666, 0.8333333333333334], ['Cl', 0.3333333333333333, 0.6666666666666666, 1.0], ['Na', 0.3333333333333333, 0.8333333333333334, 0.0], ['Cl', 0.3333333333333333, 0.8333333333333334, 0.16666666666666666], ['Na', 0.3333333333333333, 0.8333333333333334, 0.3333333333333333], ['Cl', 0.3333333333333333, 0.8333333333333334, 0.5], ['Na', 0.3333333333333333, 0.8333333333333334, 0.6666666666666666], ['Cl', 0.3333333333333333, 0.8333333333333334, 0.8333333333333334], ['Na', 0.3333333333333333, 0.8333333333333334, 1.0], ['Cl', 0.3333333333333333, 1.0, 0.0], ['Na', 0.3333333333333333, 1.0, 0.16666666666666666], ['Cl', 0.3333333333333333, 1.0, 0.3333333333333333], ['Na', 0.3333333333333333, 1.0, 0.5], ['Cl', 0.3333333333333333, 1.0, 0.6666666666666666], ['Na', 0.3333333333333333, 1.0, 0.8333333333333334], ['Cl', 0.3333333333333333, 1.0, 1.0], ['Na', 0.5, 0.0, 0.0], ['Cl', 0.5, 0.0, 0.16666666666666666], ['Na', 0.5, 0.0, 0.3333333333333333], ['Cl', 0.5, 0.0, 0.5], ['Na', 0.5, 0.0, 0.6666666666666666], ['Cl', 0.5, 0.0, 0.8333333333333334], ['Na', 0.5, 0.0, 1.0], ['Cl', 0.5, 0.16666666666666666, 0.0], ['Na', 0.5, 0.16666666666666666, 0.16666666666666666], ['Cl', 0.5, 0.16666666666666666, 0.3333333333333333], ['Na', 0.5, 0.16666666666666666, 0.5], ['Cl', 0.5, 0.16666666666666666, 0.6666666666666666], ['Na', 0.5, 0.16666666666666666, 0.8333333333333334], ['Cl', 0.5, 0.16666666666666666, 1.0], ['Na', 0.5, 0.3333333333333333, 0.0], ['Cl', 0.5, 0.3333333333333333, 0.16666666666666666], ['Na', 0.5, 0.3333333333333333, 0.3333333333333333], ['Cl', 0.5, 0.3333333333333333, 0.5], ['Na', 0.5, 0.3333333333333333, 0.6666666666666666], ['Cl', 0.5, 0.3333333333333333, 0.8333333333333334], ['Na', 0.5, 0.3333333333333333, 1.0], ['Cl', 0.5, 0.5, 0.0], ['Na', 0.5, 0.5, 0.16666666666666666], ['Cl', 0.5, 0.5, 0.3333333333333333], ['Na', 0.5, 0.5, 0.5], ['Cl', 0.5, 0.5, 0.6666666666666666], ['Na', 0.5, 0.5, 0.8333333333333334], ['Cl', 0.5, 0.5, 1.0], ['Na', 0.5, 0.6666666666666666, 0.0], ['Cl', 0.5, 0.6666666666666666, 0.16666666666666666], ['Na', 0.5, 0.6666666666666666, 0.3333333333333333], ['Cl', 0.5, 0.6666666666666666, 0.5], ['Na', 0.5, 0.6666666666666666, 0.6666666666666666], ['Cl', 0.5, 0.6666666666666666, 0.8333333333333334], ['Na', 0.5, 0.6666666666666666, 1.0], ['Cl', 0.5, 0.8333333333333334, 0.0], ['Na', 0.5, 0.8333333333333334, 0.16666666666666666], ['Cl', 0.5, 0.8333333333333334, 0.3333333333333333], ['Na', 0.5, 0.8333333333333334, 0.5], ['Cl', 0.5, 0.8333333333333334, 0.6666666666666666], ['Na', 0.5, 0.8333333333333334, 0.8333333333333334], ['Cl', 0.5, 0.8333333333333334, 1.0], ['Na', 0.5, 1.0, 0.0], ['Cl', 0.5, 1.0, 0.16666666666666666], ['Na', 0.5, 1.0, 0.3333333333333333], ['Cl', 0.5, 1.0, 0.5], ['Na', 0.5, 1.0, 0.6666666666666666], ['Cl', 0.5, 1.0, 0.8333333333333334], ['Na', 0.5, 1.0, 1.0], ['Cl', 0.6666666666666666, 0.0, 0.0], ['Na', 0.6666666666666666, 0.0, 0.16666666666666666], ['Cl', 0.6666666666666666, 0.0, 0.3333333333333333], ['Na', 0.6666666666666666, 0.0, 0.5], ['Cl', 0.6666666666666666, 0.0, 0.6666666666666666], ['Na', 0.6666666666666666, 0.0, 0.8333333333333334], ['Cl', 0.6666666666666666, 0.0, 1.0], ['Na', 0.6666666666666666, 0.16666666666666666, 0.0], ['Cl', 0.6666666666666666, 0.16666666666666666, 0.16666666666666666], ['Na', 0.6666666666666666, 0.16666666666666666, 0.3333333333333333], ['Cl', 0.6666666666666666, 0.16666666666666666, 0.5], ['Na', 0.6666666666666666, 0.16666666666666666, 0.6666666666666666], ['Cl', 0.6666666666666666, 0.16666666666666666, 0.8333333333333334], ['Na', 0.6666666666666666, 0.16666666666666666, 1.0], ['Cl', 0.6666666666666666, 0.3333333333333333, 0.0], ['Na', 0.6666666666666666, 0.3333333333333333, 0.16666666666666666], ['Cl', 0.6666666666666666, 0.3333333333333333, 0.3333333333333333], ['Na', 0.6666666666666666, 0.3333333333333333, 0.5], ['Cl', 0.6666666666666666, 0.3333333333333333, 0.6666666666666666], ['Na', 0.6666666666666666, 0.3333333333333333, 0.8333333333333334], ['Cl', 0.6666666666666666, 0.3333333333333333, 1.0], ['Na', 0.6666666666666666, 0.5, 0.0], ['Cl', 0.6666666666666666, 0.5, 0.16666666666666666], ['Na', 0.6666666666666666, 0.5, 0.3333333333333333], ['Cl', 0.6666666666666666, 0.5, 0.5], ['Na', 0.6666666666666666, 0.5, 0.6666666666666666], ['Cl', 0.6666666666666666, 0.5, 0.8333333333333334], ['Na', 0.6666666666666666, 0.5, 1.0], ['Cl', 0.6666666666666666, 0.6666666666666666, 0.0], ['Na', 0.6666666666666666, 0.6666666666666666, 0.16666666666666666], ['Cl', 0.6666666666666666, 0.6666666666666666, 0.3333333333333333], ['Na', 0.6666666666666666, 0.6666666666666666, 0.5], ['Cl', 0.6666666666666666, 0.6666666666666666, 0.6666666666666666], ['Na', 0.6666666666666666, 0.6666666666666666, 0.8333333333333334], ['Cl', 0.6666666666666666, 0.6666666666666666, 1.0], ['Na', 0.6666666666666666, 0.8333333333333334, 0.0], ['Cl', 0.6666666666666666, 0.8333333333333334, 0.16666666666666666], ['Na', 0.6666666666666666, 0.8333333333333334, 0.3333333333333333], ['Cl', 0.6666666666666666, 0.8333333333333334, 0.5], ['Na', 0.6666666666666666, 0.8333333333333334, 0.6666666666666666], ['Cl', 0.6666666666666666, 0.8333333333333334, 0.8333333333333334], ['Na', 0.6666666666666666, 0.8333333333333334, 1.0], ['Cl', 0.6666666666666666, 1.0, 0.0], ['Na', 0.6666666666666666, 1.0, 0.16666666666666666], ['Cl', 0.6666666666666666, 1.0, 0.3333333333333333], ['Na', 0.6666666666666666, 1.0, 0.5], ['Cl', 0.6666666666666666, 1.0, 0.6666666666666666], ['Na', 0.6666666666666666, 1.0, 0.8333333333333334], ['Cl', 0.6666666666666666, 1.0, 1.0], ['Na', 0.8333333333333334, 0.0, 0.0], ['Cl', 0.8333333333333334, 0.0, 0.16666666666666666], ['Na', 0.8333333333333334, 0.0, 0.3333333333333333], ['Cl', 0.8333333333333334, 0.0, 0.5], ['Na', 0.8333333333333334, 0.0, 0.6666666666666666], ['Cl', 0.8333333333333334, 0.0, 0.8333333333333334], ['Na', 0.8333333333333334, 0.0, 1.0], ['Cl', 0.8333333333333334, 0.16666666666666666, 0.0], ['Na', 0.8333333333333334, 0.16666666666666666, 0.16666666666666666], ['Cl', 0.8333333333333334, 0.16666666666666666, 0.3333333333333333], ['Na', 0.8333333333333334, 0.16666666666666666, 0.5], ['Cl', 0.8333333333333334, 0.16666666666666666, 0.6666666666666666], ['Na', 0.8333333333333334, 0.16666666666666666, 0.8333333333333334], ['Cl', 0.8333333333333334, 0.16666666666666666, 1.0], ['Na', 0.8333333333333334, 0.3333333333333333, 0.0], ['Cl', 0.8333333333333334, 0.3333333333333333, 0.16666666666666666], ['Na', 0.8333333333333334, 0.3333333333333333, 0.3333333333333333], ['Cl', 0.8333333333333334, 0.3333333333333333, 0.5], ['Na', 0.8333333333333334, 0.3333333333333333, 0.6666666666666666], ['Cl', 0.8333333333333334, 0.3333333333333333, 0.8333333333333334], ['Na', 0.8333333333333334, 0.3333333333333333, 1.0], ['Cl', 0.8333333333333334, 0.5, 0.0], ['Na', 0.8333333333333334, 0.5, 0.16666666666666666], ['Cl', 0.8333333333333334, 0.5, 0.3333333333333333], ['Na', 0.8333333333333334, 0.5, 0.5], ['Cl', 0.8333333333333334, 0.5, 0.6666666666666666], ['Na', 0.8333333333333334, 0.5, 0.8333333333333334], ['Cl', 0.8333333333333334, 0.5, 1.0], ['Na', 0.8333333333333334, 0.6666666666666666, 0.0], ['Cl', 0.8333333333333334, 0.6666666666666666, 0.16666666666666666], ['Na', 0.8333333333333334, 0.6666666666666666, 0.3333333333333333], ['Cl', 0.8333333333333334, 0.6666666666666666, 0.5], ['Na', 0.8333333333333334, 0.6666666666666666, 0.6666666666666666], ['Cl', 0.8333333333333334, 0.6666666666666666, 0.8333333333333334], ['Na', 0.8333333333333334, 0.6666666666666666, 1.0], ['Cl', 0.8333333333333334, 0.8333333333333334, 0.0], ['Na', 0.8333333333333334, 0.8333333333333334, 0.16666666666666666], ['Cl', 0.8333333333333334, 0.8333333333333334, 0.3333333333333333], ['Na', 0.8333333333333334, 0.8333333333333334, 0.5], ['Cl', 0.8333333333333334, 0.8333333333333334, 0.6666666666666666], ['Na', 0.8333333333333334, 0.8333333333333334, 0.8333333333333334], ['Cl', 0.8333333333333334, 0.8333333333333334, 1.0], ['Na', 0.8333333333333334, 1.0, 0.0], ['Cl', 0.8333333333333334, 1.0, 0.16666666666666666], ['Na', 0.8333333333333334, 1.0, 0.3333333333333333], ['Cl', 0.8333333333333334, 1.0, 0.5], ['Na', 0.8333333333333334, 1.0, 0.6666666666666666], ['Cl', 0.8333333333333334, 1.0, 0.8333333333333334], ['Na', 0.8333333333333334, 1.0, 1.0], ['Cl', 1.0, 0.0, 0.0], ['Na', 1.0, 0.0, 0.16666666666666666], ['Cl', 1.0, 0.0, 0.3333333333333333], ['Na', 1.0, 0.0, 0.5], ['Cl', 1.0, 0.0, 0.6666666666666666], ['Na', 1.0, 0.0, 0.8333333333333334], ['Cl', 1.0, 0.0, 1.0], ['Na', 1.0, 0.16666666666666666, 0.0], ['Cl', 1.0, 0.16666666666666666, 0.16666666666666666], ['Na', 1.0, 0.16666666666666666, 0.3333333333333333], ['Cl', 1.0, 0.16666666666666666, 0.5], ['Na', 1.0, 0.16666666666666666, 0.6666666666666666], ['Cl', 1.0, 0.16666666666666666, 0.8333333333333334], ['Na', 1.0, 0.16666666666666666, 1.0], ['Cl', 1.0, 0.3333333333333333, 0.0], ['Na', 1.0, 0.3333333333333333, 0.16666666666666666], ['Cl', 1.0, 0.3333333333333333, 0.3333333333333333], ['Na', 1.0, 0.3333333333333333, 0.5], ['Cl', 1.0, 0.3333333333333333, 0.6666666666666666], ['Na', 1.0, 0.3333333333333333, 0.8333333333333334], ['Cl', 1.0, 0.3333333333333333, 1.0], ['Na', 1.0, 0.5, 0.0], ['Cl', 1.0, 0.5, 0.16666666666666666], ['Na', 1.0, 0.5, 0.3333333333333333], ['Cl', 1.0, 0.5, 0.5], ['Na', 1.0, 0.5, 0.6666666666666666], ['Cl', 1.0, 0.5, 0.8333333333333334], ['Na', 1.0, 0.5, 1.0], ['Cl', 1.0, 0.6666666666666666, 0.0], ['Na', 1.0, 0.6666666666666666, 0.16666666666666666], ['Cl', 1.0, 0.6666666666666666, 0.3333333333333333], ['Na', 1.0, 0.6666666666666666, 0.5], ['Cl', 1.0, 0.6666666666666666, 0.6666666666666666], ['Na', 1.0, 0.6666666666666666, 0.8333333333333334], ['Cl', 1.0, 0.6666666666666666, 1.0], ['Na', 1.0, 0.8333333333333334, 0.0], ['Cl', 1.0, 0.8333333333333334, 0.16666666666666666], ['Na', 1.0, 0.8333333333333334, 0.3333333333333333], ['Cl', 1.0, 0.8333333333333334, 0.5], ['Na', 1.0, 0.8333333333333334, 0.6666666666666666], ['Cl', 1.0, 0.8333333333333334, 0.8333333333333334], ['Na', 1.0, 0.8333333333333334, 1.0], ['Cl', 1.0, 1.0, 0.0], ['Na', 1.0, 1.0, 0.16666666666666666], ['Cl', 1.0, 1.0, 0.3333333333333333], ['Na', 1.0, 1.0, 0.5], ['Cl', 1.0, 1.0, 0.6666666666666666], ['Na', 1.0, 1.0, 0.8333333333333334], ['Cl', 1.0, 1.0, 1.0]]
a1 = [['Cl', 0.033333333, 0.0, 0.33333], ['Na', 0.0, 0.0, 0.16666666666666666], ['Cl', 0.0, 0.0, 0.3333333333333333], ['Na', 0.0, 0.0, 0.5], ['Cl', 0.0, 0.0, 0.6666666666666666], ['Na', 0.0, 0.0, 0.8333333333333334], ['Cl', 0.0, 0.0, 1.0], ['Na', 0.0, 0.16666666666666666, 0.0], ['Cl', 0.0, 0.16666666666666666, 0.16666666666666666], ['Na', 0.0, 0.16666666666666666, 0.3333333333333333], ['Cl', 0.0, 0.16666666666666666, 0.5], ['Na', 0.0, 0.16666666666666666, 0.6666666666666666], ['Cl', 0.0, 0.16666666666666666, 0.8333333333333334], ['Na', 0.0, 0.16666666666666666, 1.0], ['Cl', 0.0, 0.3333333333333333, 0.0], ['Na', 0.0, 0.3333333333333333, 0.16666666666666666], ['Cl', 0.0, 0.3333333333333333, 0.3333333333333333], ['Na', 0.0, 0.3333333333333333, 0.5], ['Cl', 0.0, 0.3333333333333333, 0.6666666666666666], ['Na', 0.0, 0.3333333333333333, 0.8333333333333334], ['Cl', 0.0, 0.3333333333333333, 1.0], ['Na', 0.0, 0.5, 0.0], ['Cl', 0.0, 0.5, 0.16666666666666666], ['Na', 0.0, 0.5, 0.3333333333333333], ['Cl', 0.0, 0.5, 0.5], ['Na', 0.0, 0.5, 0.6666666666666666], ['Cl', 0.0, 0.5, 0.8333333333333334], ['Na', 0.0, 0.5, 1.0], ['Cl', 0.0, 0.6666666666666666, 0.0], ['Na', 0.0, 0.6666666666666666, 0.16666666666666666], ['Cl', 0.0, 0.6666666666666666, 0.3333333333333333], ['Na', 0.0, 0.6666666666666666, 0.5], ['Cl', 0.0, 0.6666666666666666, 0.6666666666666666], ['Na', 0.0, 0.6666666666666666, 0.8333333333333334], ['Cl', 0.0, 0.6666666666666666, 1.0], ['Na', 0.0, 0.8333333333333334, 0.0], ['Cl', 0.0, 0.8333333333333334, 0.16666666666666666], ['Na', 0.0, 0.8333333333333334, 0.3333333333333333], ['Cl', 0.0, 0.8333333333333334, 0.5], ['Na', 0.0, 0.8333333333333334, 0.6666666666666666], ['Cl', 0.0, 0.8333333333333334, 0.8333333333333334], ['Na', 0.0, 0.8333333333333334, 1.0], ['Cl', 0.0, 1.0, 0.0], ['Na', 0.0, 1.0, 0.16666666666666666], ['Cl', 0.0, 1.0, 0.3333333333333333], ['Na', 0.0, 1.0, 0.5], ['Cl', 0.0, 1.0, 0.6666666666666666], ['Na', 0.0, 1.0, 0.8333333333333334], ['Cl', 0.0, 1.0, 1.0], ['Na', 0.16666666666666666, 0.0, 0.0], ['Cl', 0.16666666666666666, 0.0, 0.16666666666666666], ['Na', 0.16666666666666666, 0.0, 0.3333333333333333], ['Cl', 0.16666666666666666, 0.0, 0.5], ['Na', 0.16666666666666666, 0.0, 0.6666666666666666], ['Cl', 0.16666666666666666, 0.0, 0.8333333333333334], ['Na', 0.16666666666666666, 0.0, 1.0], ['Cl', 0.16666666666666666, 0.16666666666666666, 0.0], ['Na', 0.16666666666666666, 0.16666666666666666, 0.16666666666666666], ['Cl', 0.16666666666666666, 0.16666666666666666, 0.3333333333333333], ['Na', 0.16666666666666666, 0.16666666666666666, 0.5], ['Cl', 0.16666666666666666, 0.16666666666666666, 0.6666666666666666], ['Na', 0.16666666666666666, 0.16666666666666666, 0.8333333333333334], ['Cl', 0.16666666666666666, 0.16666666666666666, 1.0], ['Na', 0.16666666666666666, 0.3333333333333333, 0.0], ['Cl', 0.16666666666666666, 0.3333333333333333, 0.16666666666666666], ['Na', 0.16666666666666666, 0.3333333333333333, 0.3333333333333333], ['Cl', 0.16666666666666666, 0.3333333333333333, 0.5], ['Na', 0.16666666666666666, 0.3333333333333333, 0.6666666666666666], ['Cl', 0.16666666666666666, 0.3333333333333333, 0.8333333333333334], ['Na', 0.16666666666666666, 0.3333333333333333, 1.0], ['Cl', 0.16666666666666666, 0.5, 0.0], ['Na', 0.16666666666666666, 0.5, 0.16666666666666666], ['Cl', 0.16666666666666666, 0.5, 0.3333333333333333], ['Na', 0.16666666666666666, 0.5, 0.5], ['Cl', 0.16666666666666666, 0.5, 0.6666666666666666], ['Na', 0.16666666666666666, 0.5, 0.8333333333333334], ['Cl', 0.16666666666666666, 0.5, 1.0], ['Na', 0.16666666666666666, 0.6666666666666666, 0.0], ['Cl', 0.16666666666666666, 0.6666666666666666, 0.16666666666666666], ['Na', 0.16666666666666666, 0.6666666666666666, 0.3333333333333333], ['Cl', 0.16666666666666666, 0.6666666666666666, 0.5], ['Na', 0.16666666666666666, 0.6666666666666666, 0.6666666666666666], ['Cl', 0.16666666666666666, 0.6666666666666666, 0.8333333333333334], ['Na', 0.16666666666666666, 0.6666666666666666, 1.0], ['Cl', 0.16666666666666666, 0.8333333333333334, 0.0], ['Na', 0.16666666666666666, 0.8333333333333334, 0.16666666666666666], ['Cl', 0.16666666666666666, 0.8333333333333334, 0.3333333333333333], ['Na', 0.16666666666666666, 0.8333333333333334, 0.5], ['Cl', 0.16666666666666666, 0.8333333333333334, 0.6666666666666666], ['Na', 0.16666666666666666, 0.8333333333333334, 0.8333333333333334], ['Cl', 0.16666666666666666, 0.8333333333333334, 1.0], ['Na', 0.16666666666666666, 1.0, 0.0], ['Cl', 0.16666666666666666, 1.0, 0.16666666666666666], ['Na', 0.16666666666666666, 1.0, 0.3333333333333333], ['Cl', 0.16666666666666666, 1.0, 0.5], ['Na', 0.16666666666666666, 1.0, 0.6666666666666666], ['Cl', 0.16666666666666666, 1.0, 0.8333333333333334], ['Na', 0.16666666666666666, 1.0, 1.0], ['Cl', 0.3333333333333333, 0.0, 0.0], ['Na', 0.3333333333333333, 0.0, 0.16666666666666666], ['Cl', 0.3333333333333333, 0.0, 0.3333333333333333], ['Na', 0.3333333333333333, 0.0, 0.5], ['Cl', 0.3333333333333333, 0.0, 0.6666666666666666], ['Na', 0.3333333333333333, 0.0, 0.8333333333333334], ['Cl', 0.3333333333333333, 0.0, 1.0], ['Na', 0.3333333333333333, 0.16666666666666666, 0.0], ['Cl', 0.3333333333333333, 0.16666666666666666, 0.16666666666666666], ['Na', 0.3333333333333333, 0.16666666666666666, 0.3333333333333333], ['Cl', 0.3333333333333333, 0.16666666666666666, 0.5], ['Na', 0.3333333333333333, 0.16666666666666666, 0.6666666666666666], ['Cl', 0.3333333333333333, 0.16666666666666666, 0.8333333333333334], ['Na', 0.3333333333333333, 0.16666666666666666, 1.0], ['Cl', 0.3333333333333333, 0.3333333333333333, 0.0], ['Na', 0.3333333333333333, 0.3333333333333333, 0.16666666666666666], ['Cl', 0.3333333333333333, 0.3333333333333333, 0.3333333333333333], ['Na', 0.3333333333333333, 0.3333333333333333, 0.5], ['Cl', 0.3333333333333333, 0.3333333333333333, 0.6666666666666666], ['Na', 0.3333333333333333, 0.3333333333333333, 0.8333333333333334], ['Cl', 0.3333333333333333, 0.3333333333333333, 1.0], ['Na', 0.3333333333333333, 0.5, 0.0], ['Cl', 0.3333333333333333, 0.5, 0.16666666666666666], ['Na', 0.3333333333333333, 0.5, 0.3333333333333333], ['Cl', 0.3333333333333333, 0.5, 0.5], ['Na', 0.3333333333333333, 0.5, 0.6666666666666666], ['Cl', 0.3333333333333333, 0.5, 0.8333333333333334], ['Na', 0.3333333333333333, 0.5, 1.0], ['Cl', 0.3333333333333333, 0.6666666666666666, 0.0], ['Na', 0.3333333333333333, 0.6666666666666666, 0.16666666666666666], ['Cl', 0.3333333333333333, 0.6666666666666666, 0.3333333333333333], ['Na', 0.3333333333333333, 0.6666666666666666, 0.5], ['Cl', 0.3333333333333333, 0.6666666666666666, 0.6666666666666666], ['Na', 0.3333333333333333, 0.6666666666666666, 0.8333333333333334], ['Cl', 0.3333333333333333, 0.6666666666666666, 1.0], ['Na', 0.3333333333333333, 0.8333333333333334, 0.0], ['Cl', 0.3333333333333333, 0.8333333333333334, 0.16666666666666666], ['Na', 0.3333333333333333, 0.8333333333333334, 0.3333333333333333], ['Cl', 0.3333333333333333, 0.8333333333333334, 0.5], ['Na', 0.3333333333333333, 0.8333333333333334, 0.6666666666666666], ['Cl', 0.3333333333333333, 0.8333333333333334, 0.8333333333333334], ['Na', 0.3333333333333333, 0.8333333333333334, 1.0], ['Cl', 0.3333333333333333, 1.0, 0.0], ['Na', 0.3333333333333333, 1.0, 0.16666666666666666], ['Cl', 0.3333333333333333, 1.0, 0.3333333333333333], ['Na', 0.3333333333333333, 1.0, 0.5], ['Cl', 0.3333333333333333, 1.0, 0.6666666666666666], ['Na', 0.3333333333333333, 1.0, 0.8333333333333334], ['Cl', 0.3333333333333333, 1.0, 1.0], ['Na', 0.5, 0.0, 0.0], ['Cl', 0.5, 0.0, 0.16666666666666666], ['Na', 0.5, 0.0, 0.3333333333333333], ['Cl', 0.5, 0.0, 0.5], ['Na', 0.5, 0.0, 0.6666666666666666], ['Cl', 0.5, 0.0, 0.8333333333333334], ['Na', 0.5, 0.0, 1.0], ['Cl', 0.5, 0.16666666666666666, 0.0], ['Na', 0.5, 0.16666666666666666, 0.16666666666666666], ['Cl', 0.5, 0.16666666666666666, 0.3333333333333333], ['Na', 0.5, 0.16666666666666666, 0.5], ['Cl', 0.5, 0.16666666666666666, 0.6666666666666666], ['Na', 0.5, 0.16666666666666666, 0.8333333333333334], ['Cl', 0.5, 0.16666666666666666, 1.0], ['Na', 0.5, 0.3333333333333333, 0.0], ['Cl', 0.5, 0.3333333333333333, 0.16666666666666666], ['Na', 0.5, 0.3333333333333333, 0.3333333333333333], ['Cl', 0.5, 0.3333333333333333, 0.5], ['Na', 0.5, 0.3333333333333333, 0.6666666666666666], ['Cl', 0.5, 0.3333333333333333, 0.8333333333333334], ['Na', 0.5, 0.3333333333333333, 1.0], ['Cl', 0.5, 0.5, 0.0], ['Na', 0.5, 0.5, 0.16666666666666666], ['Cl', 0.5, 0.5, 0.3333333333333333], ['Na', 0.5, 0.5, 0.5], ['Cl', 0.5, 0.5, 0.6666666666666666], ['Na', 0.5, 0.5, 0.8333333333333334], ['Cl', 0.5, 0.5, 1.0], ['Na', 0.5, 0.6666666666666666, 0.0], ['Cl', 0.5, 0.6666666666666666, 0.16666666666666666], ['Na', 0.5, 0.6666666666666666, 0.3333333333333333], ['Cl', 0.5, 0.6666666666666666, 0.5], ['Na', 0.5, 0.6666666666666666, 0.6666666666666666], ['Cl', 0.5, 0.6666666666666666, 0.8333333333333334], ['Na', 0.5, 0.6666666666666666, 1.0], ['Cl', 0.5, 0.8333333333333334, 0.0], ['Na', 0.5, 0.8333333333333334, 0.16666666666666666], ['Cl', 0.5, 0.8333333333333334, 0.3333333333333333], ['Na', 0.5, 0.8333333333333334, 0.5], ['Cl', 0.5, 0.8333333333333334, 0.6666666666666666], ['Na', 0.5, 0.8333333333333334, 0.8333333333333334], ['Cl', 0.5, 0.8333333333333334, 1.0], ['Na', 0.5, 1.0, 0.0], ['Cl', 0.5, 1.0, 0.16666666666666666], ['Na', 0.5, 1.0, 0.3333333333333333], ['Cl', 0.5, 1.0, 0.5], ['Na', 0.5, 1.0, 0.6666666666666666], ['Cl', 0.5, 1.0, 0.8333333333333334], ['Na', 0.5, 1.0, 1.0], ['Cl', 0.6666666666666666, 0.0, 0.0], ['Na', 0.6666666666666666, 0.0, 0.16666666666666666], ['Cl', 0.6666666666666666, 0.0, 0.3333333333333333], ['Na', 0.6666666666666666, 0.0, 0.5], ['Cl', 0.6666666666666666, 0.0, 0.6666666666666666], ['Na', 0.6666666666666666, 0.0, 0.8333333333333334], ['Cl', 0.6666666666666666, 0.0, 1.0], ['Na', 0.6666666666666666, 0.16666666666666666, 0.0], ['Cl', 0.6666666666666666, 0.16666666666666666, 0.16666666666666666], ['Na', 0.6666666666666666, 0.16666666666666666, 0.3333333333333333], ['Cl', 0.6666666666666666, 0.16666666666666666, 0.5], ['Na', 0.6666666666666666, 0.16666666666666666, 0.6666666666666666], ['Cl', 0.6666666666666666, 0.16666666666666666, 0.8333333333333334], ['Na', 0.6666666666666666, 0.16666666666666666, 1.0], ['Cl', 0.6666666666666666, 0.3333333333333333, 0.0], ['Na', 0.6666666666666666, 0.3333333333333333, 0.16666666666666666], ['Cl', 0.6666666666666666, 0.3333333333333333, 0.3333333333333333], ['Na', 0.6666666666666666, 0.3333333333333333, 0.5], ['Cl', 0.6666666666666666, 0.3333333333333333, 0.6666666666666666], ['Na', 0.6666666666666666, 0.3333333333333333, 0.8333333333333334], ['Cl', 0.6666666666666666, 0.3333333333333333, 1.0], ['Na', 0.6666666666666666, 0.5, 0.0], ['Cl', 0.6666666666666666, 0.5, 0.16666666666666666], ['Na', 0.6666666666666666, 0.5, 0.3333333333333333], ['Cl', 0.6666666666666666, 0.5, 0.5], ['Na', 0.6666666666666666, 0.5, 0.6666666666666666], ['Cl', 0.6666666666666666, 0.5, 0.8333333333333334], ['Na', 0.6666666666666666, 0.5, 1.0], ['Cl', 0.6666666666666666, 0.6666666666666666, 0.0], ['Na', 0.6666666666666666, 0.6666666666666666, 0.16666666666666666], ['Cl', 0.6666666666666666, 0.6666666666666666, 0.3333333333333333], ['Na', 0.6666666666666666, 0.6666666666666666, 0.5], ['Cl', 0.6666666666666666, 0.6666666666666666, 0.6666666666666666], ['Na', 0.6666666666666666, 0.6666666666666666, 0.8333333333333334], ['Cl', 0.6666666666666666, 0.6666666666666666, 1.0], ['Na', 0.6666666666666666, 0.8333333333333334, 0.0], ['Cl', 0.6666666666666666, 0.8333333333333334, 0.16666666666666666], ['Na', 0.6666666666666666, 0.8333333333333334, 0.3333333333333333], ['Cl', 0.6666666666666666, 0.8333333333333334, 0.5], ['Na', 0.6666666666666666, 0.8333333333333334, 0.6666666666666666], ['Cl', 0.6666666666666666, 0.8333333333333334, 0.8333333333333334], ['Na', 0.6666666666666666, 0.8333333333333334, 1.0], ['Cl', 0.6666666666666666, 1.0, 0.0], ['Na', 0.6666666666666666, 1.0, 0.16666666666666666], ['Cl', 0.6666666666666666, 1.0, 0.3333333333333333], ['Na', 0.6666666666666666, 1.0, 0.5], ['Cl', 0.6666666666666666, 1.0, 0.6666666666666666], ['Na', 0.6666666666666666, 1.0, 0.8333333333333334], ['Cl', 0.6666666666666666, 1.0, 1.0], ['Na', 0.8333333333333334, 0.0, 0.0], ['Cl', 0.8333333333333334, 0.0, 0.16666666666666666], ['Na', 0.8333333333333334, 0.0, 0.3333333333333333], ['Cl', 0.8333333333333334, 0.0, 0.5], ['Na', 0.8333333333333334, 0.0, 0.6666666666666666], ['Cl', 0.8333333333333334, 0.0, 0.8333333333333334], ['Na', 0.8333333333333334, 0.0, 1.0], ['Cl', 0.8333333333333334, 0.16666666666666666, 0.0], ['Na', 0.8333333333333334, 0.16666666666666666, 0.16666666666666666], ['Cl', 0.8333333333333334, 0.16666666666666666, 0.3333333333333333], ['Na', 0.8333333333333334, 0.16666666666666666, 0.5], ['Cl', 0.8333333333333334, 0.16666666666666666, 0.6666666666666666], ['Na', 0.8333333333333334, 0.16666666666666666, 0.8333333333333334], ['Cl', 0.8333333333333334, 0.16666666666666666, 1.0], ['Na', 0.8333333333333334, 0.3333333333333333, 0.0], ['Cl', 0.8333333333333334, 0.3333333333333333, 0.16666666666666666], ['Na', 0.8333333333333334, 0.3333333333333333, 0.3333333333333333], ['Cl', 0.8333333333333334, 0.3333333333333333, 0.5], ['Na', 0.8333333333333334, 0.3333333333333333, 0.6666666666666666], ['Cl', 0.8333333333333334, 0.3333333333333333, 0.8333333333333334], ['Na', 0.8333333333333334, 0.3333333333333333, 1.0], ['Cl', 0.8333333333333334, 0.5, 0.0], ['Na', 0.8333333333333334, 0.5, 0.16666666666666666], ['Cl', 0.8333333333333334, 0.5, 0.3333333333333333], ['Na', 0.8333333333333334, 0.5, 0.5], ['Cl', 0.8333333333333334, 0.5, 0.6666666666666666], ['Na', 0.8333333333333334, 0.5, 0.8333333333333334], ['Cl', 0.8333333333333334, 0.5, 1.0], ['Na', 0.8333333333333334, 0.6666666666666666, 0.0], ['Cl', 0.8333333333333334, 0.6666666666666666, 0.16666666666666666], ['Na', 0.8333333333333334, 0.6666666666666666, 0.3333333333333333], ['Cl', 0.8333333333333334, 0.6666666666666666, 0.5], ['Na', 0.8333333333333334, 0.6666666666666666, 0.6666666666666666], ['Cl', 0.8333333333333334, 0.6666666666666666, 0.8333333333333334], ['Na', 0.8333333333333334, 0.6666666666666666, 1.0], ['Cl', 0.8333333333333334, 0.8333333333333334, 0.0], ['Na', 0.8333333333333334, 0.8333333333333334, 0.16666666666666666], ['Cl', 0.8333333333333334, 0.8333333333333334, 0.3333333333333333], ['Na', 0.8333333333333334, 0.8333333333333334, 0.5], ['Cl', 0.8333333333333334, 0.8333333333333334, 0.6666666666666666], ['Na', 0.8333333333333334, 0.8333333333333334, 0.8333333333333334], ['Cl', 0.8333333333333334, 0.8333333333333334, 1.0], ['Na', 0.8333333333333334, 1.0, 0.0], ['Cl', 0.8333333333333334, 1.0, 0.16666666666666666], ['Na', 0.8333333333333334, 1.0, 0.3333333333333333], ['Cl', 0.8333333333333334, 1.0, 0.5], ['Na', 0.8333333333333334, 1.0, 0.6666666666666666], ['Cl', 0.8333333333333334, 1.0, 0.8333333333333334], ['Na', 0.8333333333333334, 1.0, 1.0], ['Cl', 1.0, 0.0, 0.0], ['Na', 1.0, 0.0, 0.16666666666666666], ['Cl', 1.0, 0.0, 0.3333333333333333], ['Na', 1.0, 0.0, 0.5], ['Cl', 1.0, 0.0, 0.6666666666666666], ['Na', 1.0, 0.0, 0.8333333333333334], ['Cl', 1.0, 0.0, 1.0], ['Na', 1.0, 0.16666666666666666, 0.0], ['Cl', 1.0, 0.16666666666666666, 0.16666666666666666], ['Na', 1.0, 0.16666666666666666, 0.3333333333333333], ['Cl', 1.0, 0.16666666666666666, 0.5], ['Na', 1.0, 0.16666666666666666, 0.6666666666666666], ['Cl', 1.0, 0.16666666666666666, 0.8333333333333334], ['Na', 1.0, 0.16666666666666666, 1.0], ['Cl', 1.0, 0.3333333333333333, 0.0], ['Na', 1.0, 0.3333333333333333, 0.16666666666666666], ['Cl', 1.0, 0.3333333333333333, 0.3333333333333333], ['Na', 1.0, 0.3333333333333333, 0.5], ['Cl', 1.0, 0.3333333333333333, 0.6666666666666666], ['Na', 1.0, 0.3333333333333333, 0.8333333333333334], ['Cl', 1.0, 0.3333333333333333, 1.0], ['Na', 1.0, 0.5, 0.0], ['Cl', 1.0, 0.5, 0.16666666666666666], ['Na', 1.0, 0.5, 0.3333333333333333], ['Cl', 1.0, 0.5, 0.5], ['Na', 1.0, 0.5, 0.6666666666666666], ['Cl', 1.0, 0.5, 0.8333333333333334], ['Na', 1.0, 0.5, 1.0], ['Cl', 1.0, 0.6666666666666666, 0.0], ['Na', 1.0, 0.6666666666666666, 0.16666666666666666], ['Cl', 1.0, 0.6666666666666666, 0.3333333333333333], ['Na', 1.0, 0.6666666666666666, 0.5], ['Cl', 1.0, 0.6666666666666666, 0.6666666666666666], ['Na', 1.0, 0.6666666666666666, 0.8333333333333334], ['Cl', 1.0, 0.6666666666666666, 1.0], ['Na', 1.0, 0.8333333333333334, 0.0], ['Cl', 1.0, 0.8333333333333334, 0.16666666666666666], ['Na', 1.0, 0.8333333333333334, 0.3333333333333333], ['Cl', 1.0, 0.8333333333333334, 0.5], ['Na', 1.0, 0.8333333333333334, 0.6666666666666666], ['Cl', 1.0, 0.8333333333333334, 0.8333333333333334], ['Na', 1.0, 0.8333333333333334, 1.0], ['Cl', 1.0, 1.0, 0.0], ['Na', 1.0, 1.0, 0.16666666666666666], ['Cl', 1.0, 1.0, 0.3333333333333333], ['Na', 1.0, 1.0, 0.5], ['Cl', 1.0, 1.0, 0.6666666666666666], ['Na', 1.0, 1.0, 0.8333333333333334], ['Cl', 1.0, 1.0, 1.0]]

substance_id = 777
res = get_lattice_vectors2(a)
res_a1 = get_lattice_vectors2(a1)
for id, ion in enumerate(res.keys()):
   ion_coords = [float(elem) for elem in ion.split(";")]
   # print(ion, ion_coords, res[ion])
   #print(ion_coords, "->", Counter(res[ion]))
   if id > 3:
       break
   plot_spectra(data=dict(Counter(res[ion])), ion=ion_coords, substance_id=substance_id, vector_id=id, cmap="plasma", background="#20232a")

# print(kde_array(dict(Counter(res[ion]))))
kde_arr1 = kde_array(dict(Counter(list(res.values())[0])))
kde_arr2 = kde_array(dict(Counter(list(res_a1.values())[0])))
kde_percentages = (kde_arr1 / kde_arr2)

print(np.mean(kde_percentages))
# Создать все графики
#create_all_spectrum_plots()

# Спарсить координаты сырые
#b = parse_xyz(Path("../../data/NaCl/NaCl_3x3x3.xyz"))
#print(b)
#a = [['Cl', 0.0, 0.0, 0.0], ['Na', 0.0, 0.0, 2.8201], ['Cl', 0.0, 0.0, 5.6402], ['Na', 0.0, 0.0, 8.4603], ['Cl', 0.0, 0.0, 11.2804], ['Na', 0.0, 0.0, 14.1005], ['Cl', 0.0, 0.0, 16.9206], ['Na', 0.0, 2.8201, 0.0], ['Cl', 0.0, 2.8201, 2.8201], ['Na', 0.0, 2.8201, 5.6402], ['Cl', 0.0, 2.8201, 8.4603], ['Na', 0.0, 2.8201, 11.2804], ['Cl', 0.0, 2.8201, 14.1005], ['Na', 0.0, 2.8201, 16.9206], ['Cl', 0.0, 5.6402, 0.0], ['Na', 0.0, 5.6402, 2.8201], ['Cl', 0.0, 5.6402, 5.6402], ['Na', 0.0, 5.6402, 8.4603], ['Cl', 0.0, 5.6402, 11.2804], ['Na', 0.0, 5.6402, 14.1005], ['Cl', 0.0, 5.6402, 16.9206], ['Na', 0.0, 8.4603, 0.0], ['Cl', 0.0, 8.4603, 2.8201], ['Na', 0.0, 8.4603, 5.6402], ['Cl', 0.0, 8.4603, 8.4603], ['Na', 0.0, 8.4603, 11.2804], ['Cl', 0.0, 8.4603, 14.1005], ['Na', 0.0, 8.4603, 16.9206], ['Cl', 0.0, 11.2804, 0.0], ['Na', 0.0, 11.2804, 2.8201], ['Cl', 0.0, 11.2804, 5.6402], ['Na', 0.0, 11.2804, 8.4603], ['Cl', 0.0, 11.2804, 11.2804], ['Na', 0.0, 11.2804, 14.1005], ['Cl', 0.0, 11.2804, 16.9206], ['Na', 0.0, 14.1005, 0.0], ['Cl', 0.0, 14.1005, 2.8201], ['Na', 0.0, 14.1005, 5.6402], ['Cl', 0.0, 14.1005, 8.4603], ['Na', 0.0, 14.1005, 11.2804], ['Cl', 0.0, 14.1005, 14.1005], ['Na', 0.0, 14.1005, 16.9206], ['Cl', 0.0, 16.9206, 0.0], ['Na', 0.0, 16.9206, 2.8201], ['Cl', 0.0, 16.9206, 5.6402], ['Na', 0.0, 16.9206, 8.4603], ['Cl', 0.0, 16.9206, 11.2804], ['Na', 0.0, 16.9206, 14.1005], ['Cl', 0.0, 16.9206, 16.9206], ['Na', 2.8201, 0.0, 0.0], ['Cl', 2.8201, 0.0, 2.8201], ['Na', 2.8201, 0.0, 5.6402], ['Cl', 2.8201, 0.0, 8.4603], ['Na', 2.8201, 0.0, 11.2804], ['Cl', 2.8201, 0.0, 14.1005], ['Na', 2.8201, 0.0, 16.9206], ['Cl', 2.8201, 2.8201, 0.0], ['Na', 2.8201, 2.8201, 2.8201], ['Cl', 2.8201, 2.8201, 5.6402], ['Na', 2.8201, 2.8201, 8.4603], ['Cl', 2.8201, 2.8201, 11.2804], ['Na', 2.8201, 2.8201, 14.1005], ['Cl', 2.8201, 2.8201, 16.9206], ['Na', 2.8201, 5.6402, 0.0], ['Cl', 2.8201, 5.6402, 2.8201], ['Na', 2.8201, 5.6402, 5.6402], ['Cl', 2.8201, 5.6402, 8.4603], ['Na', 2.8201, 5.6402, 11.2804], ['Cl', 2.8201, 5.6402, 14.1005], ['Na', 2.8201, 5.6402, 16.9206], ['Cl', 2.8201, 8.4603, 0.0], ['Na', 2.8201, 8.4603, 2.8201], ['Cl', 2.8201, 8.4603, 5.6402], ['Na', 2.8201, 8.4603, 8.4603], ['Cl', 2.8201, 8.4603, 11.2804], ['Na', 2.8201, 8.4603, 14.1005], ['Cl', 2.8201, 8.4603, 16.9206], ['Na', 2.8201, 11.2804, 0.0], ['Cl', 2.8201, 11.2804, 2.8201], ['Na', 2.8201, 11.2804, 5.6402], ['Cl', 2.8201, 11.2804, 8.4603], ['Na', 2.8201, 11.2804, 11.2804], ['Cl', 2.8201, 11.2804, 14.1005], ['Na', 2.8201, 11.2804, 16.9206], ['Cl', 2.8201, 14.1005, 0.0], ['Na', 2.8201, 14.1005, 2.8201], ['Cl', 2.8201, 14.1005, 5.6402], ['Na', 2.8201, 14.1005, 8.4603], ['Cl', 2.8201, 14.1005, 11.2804], ['Na', 2.8201, 14.1005, 14.1005], ['Cl', 2.8201, 14.1005, 16.9206], ['Na', 2.8201, 16.9206, 0.0], ['Cl', 2.8201, 16.9206, 2.8201], ['Na', 2.8201, 16.9206, 5.6402], ['Cl', 2.8201, 16.9206, 8.4603], ['Na', 2.8201, 16.9206, 11.2804], ['Cl', 2.8201, 16.9206, 14.1005], ['Na', 2.8201, 16.9206, 16.9206], ['Cl', 5.6402, 0.0, 0.0], ['Na', 5.6402, 0.0, 2.8201], ['Cl', 5.6402, 0.0, 5.6402], ['Na', 5.6402, 0.0, 8.4603], ['Cl', 5.6402, 0.0, 11.2804], ['Na', 5.6402, 0.0, 14.1005], ['Cl', 5.6402, 0.0, 16.9206], ['Na', 5.6402, 2.8201, 0.0], ['Cl', 5.6402, 2.8201, 2.8201], ['Na', 5.6402, 2.8201, 5.6402], ['Cl', 5.6402, 2.8201, 8.4603], ['Na', 5.6402, 2.8201, 11.2804], ['Cl', 5.6402, 2.8201, 14.1005], ['Na', 5.6402, 2.8201, 16.9206], ['Cl', 5.6402, 5.6402, 0.0], ['Na', 5.6402, 5.6402, 2.8201], ['Cl', 5.6402, 5.6402, 5.6402], ['Na', 5.6402, 5.6402, 8.4603], ['Cl', 5.6402, 5.6402, 11.2804], ['Na', 5.6402, 5.6402, 14.1005], ['Cl', 5.6402, 5.6402, 16.9206], ['Na', 5.6402, 8.4603, 0.0], ['Cl', 5.6402, 8.4603, 2.8201], ['Na', 5.6402, 8.4603, 5.6402], ['Cl', 5.6402, 8.4603, 8.4603], ['Na', 5.6402, 8.4603, 11.2804], ['Cl', 5.6402, 8.4603, 14.1005], ['Na', 5.6402, 8.4603, 16.9206], ['Cl', 5.6402, 11.2804, 0.0], ['Na', 5.6402, 11.2804, 2.8201], ['Cl', 5.6402, 11.2804, 5.6402], ['Na', 5.6402, 11.2804, 8.4603], ['Cl', 5.6402, 11.2804, 11.2804], ['Na', 5.6402, 11.2804, 14.1005], ['Cl', 5.6402, 11.2804, 16.9206], ['Na', 5.6402, 14.1005, 0.0], ['Cl', 5.6402, 14.1005, 2.8201], ['Na', 5.6402, 14.1005, 5.6402], ['Cl', 5.6402, 14.1005, 8.4603], ['Na', 5.6402, 14.1005, 11.2804], ['Cl', 5.6402, 14.1005, 14.1005], ['Na', 5.6402, 14.1005, 16.9206], ['Cl', 5.6402, 16.9206, 0.0], ['Na', 5.6402, 16.9206, 2.8201], ['Cl', 5.6402, 16.9206, 5.6402], ['Na', 5.6402, 16.9206, 8.4603], ['Cl', 5.6402, 16.9206, 11.2804], ['Na', 5.6402, 16.9206, 14.1005], ['Cl', 5.6402, 16.9206, 16.9206], ['Na', 8.4603, 0.0, 0.0], ['Cl', 8.4603, 0.0, 2.8201], ['Na', 8.4603, 0.0, 5.6402], ['Cl', 8.4603, 0.0, 8.4603], ['Na', 8.4603, 0.0, 11.2804], ['Cl', 8.4603, 0.0, 14.1005], ['Na', 8.4603, 0.0, 16.9206], ['Cl', 8.4603, 2.8201, 0.0], ['Na', 8.4603, 2.8201, 2.8201], ['Cl', 8.4603, 2.8201, 5.6402], ['Na', 8.4603, 2.8201, 8.4603], ['Cl', 8.4603, 2.8201, 11.2804], ['Na', 8.4603, 2.8201, 14.1005], ['Cl', 8.4603, 2.8201, 16.9206], ['Na', 8.4603, 5.6402, 0.0], ['Cl', 8.4603, 5.6402, 2.8201], ['Na', 8.4603, 5.6402, 5.6402], ['Cl', 8.4603, 5.6402, 8.4603], ['Na', 8.4603, 5.6402, 11.2804], ['Cl', 8.4603, 5.6402, 14.1005], ['Na', 8.4603, 5.6402, 16.9206], ['Cl', 8.4603, 8.4603, 0.0], ['Na', 8.4603, 8.4603, 2.8201], ['Cl', 8.4603, 8.4603, 5.6402], ['Na', 8.4603, 8.4603, 8.4603], ['Cl', 8.4603, 8.4603, 11.2804], ['Na', 8.4603, 8.4603, 14.1005], ['Cl', 8.4603, 8.4603, 16.9206], ['Na', 8.4603, 11.2804, 0.0], ['Cl', 8.4603, 11.2804, 2.8201], ['Na', 8.4603, 11.2804, 5.6402], ['Cl', 8.4603, 11.2804, 8.4603], ['Na', 8.4603, 11.2804, 11.2804], ['Cl', 8.4603, 11.2804, 14.1005], ['Na', 8.4603, 11.2804, 16.9206], ['Cl', 8.4603, 14.1005, 0.0], ['Na', 8.4603, 14.1005, 2.8201], ['Cl', 8.4603, 14.1005, 5.6402], ['Na', 8.4603, 14.1005, 8.4603], ['Cl', 8.4603, 14.1005, 11.2804], ['Na', 8.4603, 14.1005, 14.1005], ['Cl', 8.4603, 14.1005, 16.9206], ['Na', 8.4603, 16.9206, 0.0], ['Cl', 8.4603, 16.9206, 2.8201], ['Na', 8.4603, 16.9206, 5.6402], ['Cl', 8.4603, 16.9206, 8.4603], ['Na', 8.4603, 16.9206, 11.2804], ['Cl', 8.4603, 16.9206, 14.1005], ['Na', 8.4603, 16.9206, 16.9206], ['Cl', 11.2804, 0.0, 0.0], ['Na', 11.2804, 0.0, 2.8201], ['Cl', 11.2804, 0.0, 5.6402], ['Na', 11.2804, 0.0, 8.4603], ['Cl', 11.2804, 0.0, 11.2804], ['Na', 11.2804, 0.0, 14.1005], ['Cl', 11.2804, 0.0, 16.9206], ['Na', 11.2804, 2.8201, 0.0], ['Cl', 11.2804, 2.8201, 2.8201], ['Na', 11.2804, 2.8201, 5.6402], ['Cl', 11.2804, 2.8201, 8.4603], ['Na', 11.2804, 2.8201, 11.2804], ['Cl', 11.2804, 2.8201, 14.1005], ['Na', 11.2804, 2.8201, 16.9206], ['Cl', 11.2804, 5.6402, 0.0], ['Na', 11.2804, 5.6402, 2.8201], ['Cl', 11.2804, 5.6402, 5.6402], ['Na', 11.2804, 5.6402, 8.4603], ['Cl', 11.2804, 5.6402, 11.2804], ['Na', 11.2804, 5.6402, 14.1005], ['Cl', 11.2804, 5.6402, 16.9206], ['Na', 11.2804, 8.4603, 0.0], ['Cl', 11.2804, 8.4603, 2.8201], ['Na', 11.2804, 8.4603, 5.6402], ['Cl', 11.2804, 8.4603, 8.4603], ['Na', 11.2804, 8.4603, 11.2804], ['Cl', 11.2804, 8.4603, 14.1005], ['Na', 11.2804, 8.4603, 16.9206], ['Cl', 11.2804, 11.2804, 0.0], ['Na', 11.2804, 11.2804, 2.8201], ['Cl', 11.2804, 11.2804, 5.6402], ['Na', 11.2804, 11.2804, 8.4603], ['Cl', 11.2804, 11.2804, 11.2804], ['Na', 11.2804, 11.2804, 14.1005], ['Cl', 11.2804, 11.2804, 16.9206], ['Na', 11.2804, 14.1005, 0.0], ['Cl', 11.2804, 14.1005, 2.8201], ['Na', 11.2804, 14.1005, 5.6402], ['Cl', 11.2804, 14.1005, 8.4603], ['Na', 11.2804, 14.1005, 11.2804], ['Cl', 11.2804, 14.1005, 14.1005], ['Na', 11.2804, 14.1005, 16.9206], ['Cl', 11.2804, 16.9206, 0.0], ['Na', 11.2804, 16.9206, 2.8201], ['Cl', 11.2804, 16.9206, 5.6402], ['Na', 11.2804, 16.9206, 8.4603], ['Cl', 11.2804, 16.9206, 11.2804], ['Na', 11.2804, 16.9206, 14.1005], ['Cl', 11.2804, 16.9206, 16.9206], ['Na', 14.1005, 0.0, 0.0], ['Cl', 14.1005, 0.0, 2.8201], ['Na', 14.1005, 0.0, 5.6402], ['Cl', 14.1005, 0.0, 8.4603], ['Na', 14.1005, 0.0, 11.2804], ['Cl', 14.1005, 0.0, 14.1005], ['Na', 14.1005, 0.0, 16.9206], ['Cl', 14.1005, 2.8201, 0.0], ['Na', 14.1005, 2.8201, 2.8201], ['Cl', 14.1005, 2.8201, 5.6402], ['Na', 14.1005, 2.8201, 8.4603], ['Cl', 14.1005, 2.8201, 11.2804], ['Na', 14.1005, 2.8201, 14.1005], ['Cl', 14.1005, 2.8201, 16.9206], ['Na', 14.1005, 5.6402, 0.0], ['Cl', 14.1005, 5.6402, 2.8201], ['Na', 14.1005, 5.6402, 5.6402], ['Cl', 14.1005, 5.6402, 8.4603], ['Na', 14.1005, 5.6402, 11.2804], ['Cl', 14.1005, 5.6402, 14.1005], ['Na', 14.1005, 5.6402, 16.9206], ['Cl', 14.1005, 8.4603, 0.0], ['Na', 14.1005, 8.4603, 2.8201], ['Cl', 14.1005, 8.4603, 5.6402], ['Na', 14.1005, 8.4603, 8.4603], ['Cl', 14.1005, 8.4603, 11.2804], ['Na', 14.1005, 8.4603, 14.1005], ['Cl', 14.1005, 8.4603, 16.9206], ['Na', 14.1005, 11.2804, 0.0], ['Cl', 14.1005, 11.2804, 2.8201], ['Na', 14.1005, 11.2804, 5.6402], ['Cl', 14.1005, 11.2804, 8.4603], ['Na', 14.1005, 11.2804, 11.2804], ['Cl', 14.1005, 11.2804, 14.1005], ['Na', 14.1005, 11.2804, 16.9206], ['Cl', 14.1005, 14.1005, 0.0], ['Na', 14.1005, 14.1005, 2.8201], ['Cl', 14.1005, 14.1005, 5.6402], ['Na', 14.1005, 14.1005, 8.4603], ['Cl', 14.1005, 14.1005, 11.2804], ['Na', 14.1005, 14.1005, 14.1005], ['Cl', 14.1005, 14.1005, 16.9206], ['Na', 14.1005, 16.9206, 0.0], ['Cl', 14.1005, 16.9206, 2.8201], ['Na', 14.1005, 16.9206, 5.6402], ['Cl', 14.1005, 16.9206, 8.4603], ['Na', 14.1005, 16.9206, 11.2804], ['Cl', 14.1005, 16.9206, 14.1005], ['Na', 14.1005, 16.9206, 16.9206], ['Cl', 16.9206, 0.0, 0.0], ['Na', 16.9206, 0.0, 2.8201], ['Cl', 16.9206, 0.0, 5.6402], ['Na', 16.9206, 0.0, 8.4603], ['Cl', 16.9206, 0.0, 11.2804], ['Na', 16.9206, 0.0, 14.1005], ['Cl', 16.9206, 0.0, 16.9206], ['Na', 16.9206, 2.8201, 0.0], ['Cl', 16.9206, 2.8201, 2.8201], ['Na', 16.9206, 2.8201, 5.6402], ['Cl', 16.9206, 2.8201, 8.4603], ['Na', 16.9206, 2.8201, 11.2804], ['Cl', 16.9206, 2.8201, 14.1005], ['Na', 16.9206, 2.8201, 16.9206], ['Cl', 16.9206, 5.6402, 0.0], ['Na', 16.9206, 5.6402, 2.8201], ['Cl', 16.9206, 5.6402, 5.6402], ['Na', 16.9206, 5.6402, 8.4603], ['Cl', 16.9206, 5.6402, 11.2804], ['Na', 16.9206, 5.6402, 14.1005], ['Cl', 16.9206, 5.6402, 16.9206], ['Na', 16.9206, 8.4603, 0.0], ['Cl', 16.9206, 8.4603, 2.8201], ['Na', 16.9206, 8.4603, 5.6402], ['Cl', 16.9206, 8.4603, 8.4603], ['Na', 16.9206, 8.4603, 11.2804], ['Cl', 16.9206, 8.4603, 14.1005], ['Na', 16.9206, 8.4603, 16.9206], ['Cl', 16.9206, 11.2804, 0.0], ['Na', 16.9206, 11.2804, 2.8201], ['Cl', 16.9206, 11.2804, 5.6402], ['Na', 16.9206, 11.2804, 8.4603], ['Cl', 16.9206, 11.2804, 11.2804], ['Na', 16.9206, 11.2804, 14.1005], ['Cl', 16.9206, 11.2804, 16.9206], ['Na', 16.9206, 14.1005, 0.0], ['Cl', 16.9206, 14.1005, 2.8201], ['Na', 16.9206, 14.1005, 5.6402], ['Cl', 16.9206, 14.1005, 8.4603], ['Na', 16.9206, 14.1005, 11.2804], ['Cl', 16.9206, 14.1005, 14.1005], ['Na', 16.9206, 14.1005, 16.9206], ['Cl', 16.9206, 16.9206, 0.0], ['Na', 16.9206, 16.9206, 2.8201], ['Cl', 16.9206, 16.9206, 5.6402], ['Na', 16.9206, 16.9206, 8.4603], ['Cl', 16.9206, 16.9206, 11.2804], ['Na', 16.9206, 16.9206, 14.1005], ['Cl', 16.9206, 16.9206, 16.9206]]
#a = [['ion', 0.0, 0.0, 0.0], ['ion', 0.0, 0.0, 0.5], ['ion', 0.0, 0.0, 1.0], ['ion', 0.0, 0.5, 0.0], ['ion', 0.0, 0.5, 0.5], ['ion', 0.0, 0.5, 1.0], ['ion', 0.0, 1.0, 0.0], ['ion', 0.0, 1.0, 0.5], ['ion', 0.0, 1.0, 1.0], ['ion', 0.5, 0.0, 0.0], ['ion', 0.5, 0.0, 0.5], ['ion', 0.5, 0.0, 1.0], ['ion', 0.5, 0.5, 0.0], ['ion', 0.5, 0.5, 0.5], ['ion', 0.5, 0.5, 1.0], ['ion', 0.5, 1.0, 0.0], ['ion', 0.5, 1.0, 0.5], ['ion', 0.5, 1.0, 1.0], ['ion', 1.0, 0.0, 0.0], ['ion', 1.0, 0.0, 0.5], ['ion', 1.0, 0.0, 1.0], ['ion', 1.0, 0.5, 0.0], ['ion', 1.0, 0.5, 0.5], ['ion', 1.0, 0.5, 1.0], ['ion', 1.0, 1.0, 0.0], ['ion', 1.0, 1.0, 0.5], ['ion', 1.0, 1.0, 1.0]]
#a = [['Cl', 0.0, 0.0, 0.0], ['Na', 0.0, 0.0, 2.8201], ['Cl', 0.0, 0.0, 5.6402], ['Na', 0.0, 2.8201, 0.0], ['Cl', 0.0, 2.8201, 2.8201], ['Na', 0.0, 2.8201, 5.6402], ['Cl', 0.0, 5.6402, 0.0], ['Na', 0.0, 5.6402, 2.8201], ['Cl', 0.0, 5.6402, 5.6402], ['Na', 2.8201, 0.0, 0.0], ['Cl', 2.8201, 0.0, 2.8201], ['Na', 2.8201, 0.0, 5.6402], ['Cl', 2.8201, 2.8201, 0.0], ['Na', 2.8201, 2.8201, 2.8201], ['Cl', 2.8201, 2.8201, 5.6402], ['Na', 2.8201, 5.6402, 0.0], ['Cl', 2.8201, 5.6402, 2.8201], ['Na', 2.8201, 5.6402, 5.6402], ['Cl', 5.6402, 0.0, 0.0], ['Na', 5.6402, 0.0, 2.8201], ['Cl', 5.6402, 0.0, 5.6402], ['Na', 5.6402, 2.8201, 0.0], ['Cl', 5.6402, 2.8201, 2.8201], ['Na', 5.6402, 2.8201, 5.6402], ['Cl', 5.6402, 5.6402, 0.0], ['Na', 5.6402, 5.6402, 2.8201], ['Cl', 5.6402, 5.6402, 5.6402]]
