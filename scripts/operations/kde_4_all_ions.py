from scripts.operations.lattice_microoperations import get_lattice_vectors2
from scripts.operations.spectrum_operations import kde_array
from collections import Counter

a = [['Cl', 0.0, 0.0, 0.0], ['Na', 0.0, 0.0, 0.16666666666666666], ['Cl', 0.0, 0.0, 0.3333333333333333], ['Na', 0.0, 0.0, 0.5], ['Cl', 0.0, 0.0, 0.6666666666666666], ['Na', 0.0, 0.0, 0.8333333333333334], ['Cl', 0.0, 0.0, 1.0], ['Na', 0.0, 0.16666666666666666, 0.0], ['Cl', 0.0, 0.16666666666666666, 0.16666666666666666], ['Na', 0.0, 0.16666666666666666, 0.3333333333333333], ['Cl', 0.0, 0.16666666666666666, 0.5], ['Na', 0.0, 0.16666666666666666, 0.6666666666666666], ['Cl', 0.0, 0.16666666666666666, 0.8333333333333334], ['Na', 0.0, 0.16666666666666666, 1.0], ['Cl', 0.0, 0.3333333333333333, 0.0], ['Na', 0.0, 0.3333333333333333, 0.16666666666666666], ['Cl', 0.0, 0.3333333333333333, 0.3333333333333333], ['Na', 0.0, 0.3333333333333333, 0.5], ['Cl', 0.0, 0.3333333333333333, 0.6666666666666666], ['Na', 0.0, 0.3333333333333333, 0.8333333333333334], ['Cl', 0.0, 0.3333333333333333, 1.0], ['Na', 0.0, 0.5, 0.0], ['Cl', 0.0, 0.5, 0.16666666666666666], ['Na', 0.0, 0.5, 0.3333333333333333], ['Cl', 0.0, 0.5, 0.5], ['Na', 0.0, 0.5, 0.6666666666666666], ['Cl', 0.0, 0.5, 0.8333333333333334], ['Na', 0.0, 0.5, 1.0], ['Cl', 0.0, 0.6666666666666666, 0.0], ['Na', 0.0, 0.6666666666666666, 0.16666666666666666], ['Cl', 0.0, 0.6666666666666666, 0.3333333333333333], ['Na', 0.0, 0.6666666666666666, 0.5], ['Cl', 0.0, 0.6666666666666666, 0.6666666666666666], ['Na', 0.0, 0.6666666666666666, 0.8333333333333334], ['Cl', 0.0, 0.6666666666666666, 1.0], ['Na', 0.0, 0.8333333333333334, 0.0], ['Cl', 0.0, 0.8333333333333334, 0.16666666666666666], ['Na', 0.0, 0.8333333333333334, 0.3333333333333333], ['Cl', 0.0, 0.8333333333333334, 0.5], ['Na', 0.0, 0.8333333333333334, 0.6666666666666666], ['Cl', 0.0, 0.8333333333333334, 0.8333333333333334], ['Na', 0.0, 0.8333333333333334, 1.0], ['Cl', 0.0, 1.0, 0.0], ['Na', 0.0, 1.0, 0.16666666666666666], ['Cl', 0.0, 1.0, 0.3333333333333333], ['Na', 0.0, 1.0, 0.5], ['Cl', 0.0, 1.0, 0.6666666666666666], ['Na', 0.0, 1.0, 0.8333333333333334], ['Cl', 0.0, 1.0, 1.0], ['Na', 0.16666666666666666, 0.0, 0.0], ['Cl', 0.16666666666666666, 0.0, 0.16666666666666666], ['Na', 0.16666666666666666, 0.0, 0.3333333333333333], ['Cl', 0.16666666666666666, 0.0, 0.5], ['Na', 0.16666666666666666, 0.0, 0.6666666666666666], ['Cl', 0.16666666666666666, 0.0, 0.8333333333333334], ['Na', 0.16666666666666666, 0.0, 1.0], ['Cl', 0.16666666666666666, 0.16666666666666666, 0.0], ['Na', 0.16666666666666666, 0.16666666666666666, 0.16666666666666666], ['Cl', 0.16666666666666666, 0.16666666666666666, 0.3333333333333333], ['Na', 0.16666666666666666, 0.16666666666666666, 0.5], ['Cl', 0.16666666666666666, 0.16666666666666666, 0.6666666666666666], ['Na', 0.16666666666666666, 0.16666666666666666, 0.8333333333333334], ['Cl', 0.16666666666666666, 0.16666666666666666, 1.0], ['Na', 0.16666666666666666, 0.3333333333333333, 0.0], ['Cl', 0.16666666666666666, 0.3333333333333333, 0.16666666666666666], ['Na', 0.16666666666666666, 0.3333333333333333, 0.3333333333333333], ['Cl', 0.16666666666666666, 0.3333333333333333, 0.5], ['Na', 0.16666666666666666, 0.3333333333333333, 0.6666666666666666], ['Cl', 0.16666666666666666, 0.3333333333333333, 0.8333333333333334], ['Na', 0.16666666666666666, 0.3333333333333333, 1.0], ['Cl', 0.16666666666666666, 0.5, 0.0], ['Na', 0.16666666666666666, 0.5, 0.16666666666666666], ['Cl', 0.16666666666666666, 0.5, 0.3333333333333333], ['Na', 0.16666666666666666, 0.5, 0.5], ['Cl', 0.16666666666666666, 0.5, 0.6666666666666666], ['Na', 0.16666666666666666, 0.5, 0.8333333333333334], ['Cl', 0.16666666666666666, 0.5, 1.0], ['Na', 0.16666666666666666, 0.6666666666666666, 0.0], ['Cl', 0.16666666666666666, 0.6666666666666666, 0.16666666666666666], ['Na', 0.16666666666666666, 0.6666666666666666, 0.3333333333333333], ['Cl', 0.16666666666666666, 0.6666666666666666, 0.5], ['Na', 0.16666666666666666, 0.6666666666666666, 0.6666666666666666], ['Cl', 0.16666666666666666, 0.6666666666666666, 0.8333333333333334], ['Na', 0.16666666666666666, 0.6666666666666666, 1.0], ['Cl', 0.16666666666666666, 0.8333333333333334, 0.0], ['Na', 0.16666666666666666, 0.8333333333333334, 0.16666666666666666], ['Cl', 0.16666666666666666, 0.8333333333333334, 0.3333333333333333], ['Na', 0.16666666666666666, 0.8333333333333334, 0.5], ['Cl', 0.16666666666666666, 0.8333333333333334, 0.6666666666666666], ['Na', 0.16666666666666666, 0.8333333333333334, 0.8333333333333334], ['Cl', 0.16666666666666666, 0.8333333333333334, 1.0], ['Na', 0.16666666666666666, 1.0, 0.0], ['Cl', 0.16666666666666666, 1.0, 0.16666666666666666], ['Na', 0.16666666666666666, 1.0, 0.3333333333333333], ['Cl', 0.16666666666666666, 1.0, 0.5], ['Na', 0.16666666666666666, 1.0, 0.6666666666666666], ['Cl', 0.16666666666666666, 1.0, 0.8333333333333334], ['Na', 0.16666666666666666, 1.0, 1.0], ['Cl', 0.3333333333333333, 0.0, 0.0], ['Na', 0.3333333333333333, 0.0, 0.16666666666666666], ['Cl', 0.3333333333333333, 0.0, 0.3333333333333333], ['Na', 0.3333333333333333, 0.0, 0.5], ['Cl', 0.3333333333333333, 0.0, 0.6666666666666666], ['Na', 0.3333333333333333, 0.0, 0.8333333333333334], ['Cl', 0.3333333333333333, 0.0, 1.0], ['Na', 0.3333333333333333, 0.16666666666666666, 0.0], ['Cl', 0.3333333333333333, 0.16666666666666666, 0.16666666666666666], ['Na', 0.3333333333333333, 0.16666666666666666, 0.3333333333333333], ['Cl', 0.3333333333333333, 0.16666666666666666, 0.5], ['Na', 0.3333333333333333, 0.16666666666666666, 0.6666666666666666], ['Cl', 0.3333333333333333, 0.16666666666666666, 0.8333333333333334], ['Na', 0.3333333333333333, 0.16666666666666666, 1.0], ['Cl', 0.3333333333333333, 0.3333333333333333, 0.0], ['Na', 0.3333333333333333, 0.3333333333333333, 0.16666666666666666], ['Cl', 0.3333333333333333, 0.3333333333333333, 0.3333333333333333], ['Na', 0.3333333333333333, 0.3333333333333333, 0.5], ['Cl', 0.3333333333333333, 0.3333333333333333, 0.6666666666666666], ['Na', 0.3333333333333333, 0.3333333333333333, 0.8333333333333334], ['Cl', 0.3333333333333333, 0.3333333333333333, 1.0], ['Na', 0.3333333333333333, 0.5, 0.0], ['Cl', 0.3333333333333333, 0.5, 0.16666666666666666], ['Na', 0.3333333333333333, 0.5, 0.3333333333333333], ['Cl', 0.3333333333333333, 0.5, 0.5], ['Na', 0.3333333333333333, 0.5, 0.6666666666666666], ['Cl', 0.3333333333333333, 0.5, 0.8333333333333334], ['Na', 0.3333333333333333, 0.5, 1.0], ['Cl', 0.3333333333333333, 0.6666666666666666, 0.0], ['Na', 0.3333333333333333, 0.6666666666666666, 0.16666666666666666], ['Cl', 0.3333333333333333, 0.6666666666666666, 0.3333333333333333], ['Na', 0.3333333333333333, 0.6666666666666666, 0.5], ['Cl', 0.3333333333333333, 0.6666666666666666, 0.6666666666666666], ['Na', 0.3333333333333333, 0.6666666666666666, 0.8333333333333334], ['Cl', 0.3333333333333333, 0.6666666666666666, 1.0], ['Na', 0.3333333333333333, 0.8333333333333334, 0.0], ['Cl', 0.3333333333333333, 0.8333333333333334, 0.16666666666666666], ['Na', 0.3333333333333333, 0.8333333333333334, 0.3333333333333333], ['Cl', 0.3333333333333333, 0.8333333333333334, 0.5], ['Na', 0.3333333333333333, 0.8333333333333334, 0.6666666666666666], ['Cl', 0.3333333333333333, 0.8333333333333334, 0.8333333333333334], ['Na', 0.3333333333333333, 0.8333333333333334, 1.0], ['Cl', 0.3333333333333333, 1.0, 0.0], ['Na', 0.3333333333333333, 1.0, 0.16666666666666666], ['Cl', 0.3333333333333333, 1.0, 0.3333333333333333], ['Na', 0.3333333333333333, 1.0, 0.5], ['Cl', 0.3333333333333333, 1.0, 0.6666666666666666], ['Na', 0.3333333333333333, 1.0, 0.8333333333333334], ['Cl', 0.3333333333333333, 1.0, 1.0], ['Na', 0.5, 0.0, 0.0], ['Cl', 0.5, 0.0, 0.16666666666666666], ['Na', 0.5, 0.0, 0.3333333333333333], ['Cl', 0.5, 0.0, 0.5], ['Na', 0.5, 0.0, 0.6666666666666666], ['Cl', 0.5, 0.0, 0.8333333333333334], ['Na', 0.5, 0.0, 1.0], ['Cl', 0.5, 0.16666666666666666, 0.0], ['Na', 0.5, 0.16666666666666666, 0.16666666666666666], ['Cl', 0.5, 0.16666666666666666, 0.3333333333333333], ['Na', 0.5, 0.16666666666666666, 0.5], ['Cl', 0.5, 0.16666666666666666, 0.6666666666666666], ['Na', 0.5, 0.16666666666666666, 0.8333333333333334], ['Cl', 0.5, 0.16666666666666666, 1.0], ['Na', 0.5, 0.3333333333333333, 0.0], ['Cl', 0.5, 0.3333333333333333, 0.16666666666666666], ['Na', 0.5, 0.3333333333333333, 0.3333333333333333], ['Cl', 0.5, 0.3333333333333333, 0.5], ['Na', 0.5, 0.3333333333333333, 0.6666666666666666], ['Cl', 0.5, 0.3333333333333333, 0.8333333333333334], ['Na', 0.5, 0.3333333333333333, 1.0], ['Cl', 0.5, 0.5, 0.0], ['Na', 0.5, 0.5, 0.16666666666666666], ['Cl', 0.5, 0.5, 0.3333333333333333], ['Na', 0.5, 0.5, 0.5], ['Cl', 0.5, 0.5, 0.6666666666666666], ['Na', 0.5, 0.5, 0.8333333333333334], ['Cl', 0.5, 0.5, 1.0], ['Na', 0.5, 0.6666666666666666, 0.0], ['Cl', 0.5, 0.6666666666666666, 0.16666666666666666], ['Na', 0.5, 0.6666666666666666, 0.3333333333333333], ['Cl', 0.5, 0.6666666666666666, 0.5], ['Na', 0.5, 0.6666666666666666, 0.6666666666666666], ['Cl', 0.5, 0.6666666666666666, 0.8333333333333334], ['Na', 0.5, 0.6666666666666666, 1.0], ['Cl', 0.5, 0.8333333333333334, 0.0], ['Na', 0.5, 0.8333333333333334, 0.16666666666666666], ['Cl', 0.5, 0.8333333333333334, 0.3333333333333333], ['Na', 0.5, 0.8333333333333334, 0.5], ['Cl', 0.5, 0.8333333333333334, 0.6666666666666666], ['Na', 0.5, 0.8333333333333334, 0.8333333333333334], ['Cl', 0.5, 0.8333333333333334, 1.0], ['Na', 0.5, 1.0, 0.0], ['Cl', 0.5, 1.0, 0.16666666666666666], ['Na', 0.5, 1.0, 0.3333333333333333], ['Cl', 0.5, 1.0, 0.5], ['Na', 0.5, 1.0, 0.6666666666666666], ['Cl', 0.5, 1.0, 0.8333333333333334], ['Na', 0.5, 1.0, 1.0], ['Cl', 0.6666666666666666, 0.0, 0.0], ['Na', 0.6666666666666666, 0.0, 0.16666666666666666], ['Cl', 0.6666666666666666, 0.0, 0.3333333333333333], ['Na', 0.6666666666666666, 0.0, 0.5], ['Cl', 0.6666666666666666, 0.0, 0.6666666666666666], ['Na', 0.6666666666666666, 0.0, 0.8333333333333334], ['Cl', 0.6666666666666666, 0.0, 1.0], ['Na', 0.6666666666666666, 0.16666666666666666, 0.0], ['Cl', 0.6666666666666666, 0.16666666666666666, 0.16666666666666666], ['Na', 0.6666666666666666, 0.16666666666666666, 0.3333333333333333], ['Cl', 0.6666666666666666, 0.16666666666666666, 0.5], ['Na', 0.6666666666666666, 0.16666666666666666, 0.6666666666666666], ['Cl', 0.6666666666666666, 0.16666666666666666, 0.8333333333333334], ['Na', 0.6666666666666666, 0.16666666666666666, 1.0], ['Cl', 0.6666666666666666, 0.3333333333333333, 0.0], ['Na', 0.6666666666666666, 0.3333333333333333, 0.16666666666666666], ['Cl', 0.6666666666666666, 0.3333333333333333, 0.3333333333333333], ['Na', 0.6666666666666666, 0.3333333333333333, 0.5], ['Cl', 0.6666666666666666, 0.3333333333333333, 0.6666666666666666], ['Na', 0.6666666666666666, 0.3333333333333333, 0.8333333333333334], ['Cl', 0.6666666666666666, 0.3333333333333333, 1.0], ['Na', 0.6666666666666666, 0.5, 0.0], ['Cl', 0.6666666666666666, 0.5, 0.16666666666666666], ['Na', 0.6666666666666666, 0.5, 0.3333333333333333], ['Cl', 0.6666666666666666, 0.5, 0.5], ['Na', 0.6666666666666666, 0.5, 0.6666666666666666], ['Cl', 0.6666666666666666, 0.5, 0.8333333333333334], ['Na', 0.6666666666666666, 0.5, 1.0], ['Cl', 0.6666666666666666, 0.6666666666666666, 0.0], ['Na', 0.6666666666666666, 0.6666666666666666, 0.16666666666666666], ['Cl', 0.6666666666666666, 0.6666666666666666, 0.3333333333333333], ['Na', 0.6666666666666666, 0.6666666666666666, 0.5], ['Cl', 0.6666666666666666, 0.6666666666666666, 0.6666666666666666], ['Na', 0.6666666666666666, 0.6666666666666666, 0.8333333333333334], ['Cl', 0.6666666666666666, 0.6666666666666666, 1.0], ['Na', 0.6666666666666666, 0.8333333333333334, 0.0], ['Cl', 0.6666666666666666, 0.8333333333333334, 0.16666666666666666], ['Na', 0.6666666666666666, 0.8333333333333334, 0.3333333333333333], ['Cl', 0.6666666666666666, 0.8333333333333334, 0.5], ['Na', 0.6666666666666666, 0.8333333333333334, 0.6666666666666666], ['Cl', 0.6666666666666666, 0.8333333333333334, 0.8333333333333334], ['Na', 0.6666666666666666, 0.8333333333333334, 1.0], ['Cl', 0.6666666666666666, 1.0, 0.0], ['Na', 0.6666666666666666, 1.0, 0.16666666666666666], ['Cl', 0.6666666666666666, 1.0, 0.3333333333333333], ['Na', 0.6666666666666666, 1.0, 0.5], ['Cl', 0.6666666666666666, 1.0, 0.6666666666666666], ['Na', 0.6666666666666666, 1.0, 0.8333333333333334], ['Cl', 0.6666666666666666, 1.0, 1.0], ['Na', 0.8333333333333334, 0.0, 0.0], ['Cl', 0.8333333333333334, 0.0, 0.16666666666666666], ['Na', 0.8333333333333334, 0.0, 0.3333333333333333], ['Cl', 0.8333333333333334, 0.0, 0.5], ['Na', 0.8333333333333334, 0.0, 0.6666666666666666], ['Cl', 0.8333333333333334, 0.0, 0.8333333333333334], ['Na', 0.8333333333333334, 0.0, 1.0], ['Cl', 0.8333333333333334, 0.16666666666666666, 0.0], ['Na', 0.8333333333333334, 0.16666666666666666, 0.16666666666666666], ['Cl', 0.8333333333333334, 0.16666666666666666, 0.3333333333333333], ['Na', 0.8333333333333334, 0.16666666666666666, 0.5], ['Cl', 0.8333333333333334, 0.16666666666666666, 0.6666666666666666], ['Na', 0.8333333333333334, 0.16666666666666666, 0.8333333333333334], ['Cl', 0.8333333333333334, 0.16666666666666666, 1.0], ['Na', 0.8333333333333334, 0.3333333333333333, 0.0], ['Cl', 0.8333333333333334, 0.3333333333333333, 0.16666666666666666], ['Na', 0.8333333333333334, 0.3333333333333333, 0.3333333333333333], ['Cl', 0.8333333333333334, 0.3333333333333333, 0.5], ['Na', 0.8333333333333334, 0.3333333333333333, 0.6666666666666666], ['Cl', 0.8333333333333334, 0.3333333333333333, 0.8333333333333334], ['Na', 0.8333333333333334, 0.3333333333333333, 1.0], ['Cl', 0.8333333333333334, 0.5, 0.0], ['Na', 0.8333333333333334, 0.5, 0.16666666666666666], ['Cl', 0.8333333333333334, 0.5, 0.3333333333333333], ['Na', 0.8333333333333334, 0.5, 0.5], ['Cl', 0.8333333333333334, 0.5, 0.6666666666666666], ['Na', 0.8333333333333334, 0.5, 0.8333333333333334], ['Cl', 0.8333333333333334, 0.5, 1.0], ['Na', 0.8333333333333334, 0.6666666666666666, 0.0], ['Cl', 0.8333333333333334, 0.6666666666666666, 0.16666666666666666], ['Na', 0.8333333333333334, 0.6666666666666666, 0.3333333333333333], ['Cl', 0.8333333333333334, 0.6666666666666666, 0.5], ['Na', 0.8333333333333334, 0.6666666666666666, 0.6666666666666666], ['Cl', 0.8333333333333334, 0.6666666666666666, 0.8333333333333334], ['Na', 0.8333333333333334, 0.6666666666666666, 1.0], ['Cl', 0.8333333333333334, 0.8333333333333334, 0.0], ['Na', 0.8333333333333334, 0.8333333333333334, 0.16666666666666666], ['Cl', 0.8333333333333334, 0.8333333333333334, 0.3333333333333333], ['Na', 0.8333333333333334, 0.8333333333333334, 0.5], ['Cl', 0.8333333333333334, 0.8333333333333334, 0.6666666666666666], ['Na', 0.8333333333333334, 0.8333333333333334, 0.8333333333333334], ['Cl', 0.8333333333333334, 0.8333333333333334, 1.0], ['Na', 0.8333333333333334, 1.0, 0.0], ['Cl', 0.8333333333333334, 1.0, 0.16666666666666666], ['Na', 0.8333333333333334, 1.0, 0.3333333333333333], ['Cl', 0.8333333333333334, 1.0, 0.5], ['Na', 0.8333333333333334, 1.0, 0.6666666666666666], ['Cl', 0.8333333333333334, 1.0, 0.8333333333333334], ['Na', 0.8333333333333334, 1.0, 1.0], ['Cl', 1.0, 0.0, 0.0], ['Na', 1.0, 0.0, 0.16666666666666666], ['Cl', 1.0, 0.0, 0.3333333333333333], ['Na', 1.0, 0.0, 0.5], ['Cl', 1.0, 0.0, 0.6666666666666666], ['Na', 1.0, 0.0, 0.8333333333333334], ['Cl', 1.0, 0.0, 1.0], ['Na', 1.0, 0.16666666666666666, 0.0], ['Cl', 1.0, 0.16666666666666666, 0.16666666666666666], ['Na', 1.0, 0.16666666666666666, 0.3333333333333333], ['Cl', 1.0, 0.16666666666666666, 0.5], ['Na', 1.0, 0.16666666666666666, 0.6666666666666666], ['Cl', 1.0, 0.16666666666666666, 0.8333333333333334], ['Na', 1.0, 0.16666666666666666, 1.0], ['Cl', 1.0, 0.3333333333333333, 0.0], ['Na', 1.0, 0.3333333333333333, 0.16666666666666666], ['Cl', 1.0, 0.3333333333333333, 0.3333333333333333], ['Na', 1.0, 0.3333333333333333, 0.5], ['Cl', 1.0, 0.3333333333333333, 0.6666666666666666], ['Na', 1.0, 0.3333333333333333, 0.8333333333333334], ['Cl', 1.0, 0.3333333333333333, 1.0], ['Na', 1.0, 0.5, 0.0], ['Cl', 1.0, 0.5, 0.16666666666666666], ['Na', 1.0, 0.5, 0.3333333333333333], ['Cl', 1.0, 0.5, 0.5], ['Na', 1.0, 0.5, 0.6666666666666666], ['Cl', 1.0, 0.5, 0.8333333333333334], ['Na', 1.0, 0.5, 1.0], ['Cl', 1.0, 0.6666666666666666, 0.0], ['Na', 1.0, 0.6666666666666666, 0.16666666666666666], ['Cl', 1.0, 0.6666666666666666, 0.3333333333333333], ['Na', 1.0, 0.6666666666666666, 0.5], ['Cl', 1.0, 0.6666666666666666, 0.6666666666666666], ['Na', 1.0, 0.6666666666666666, 0.8333333333333334], ['Cl', 1.0, 0.6666666666666666, 1.0], ['Na', 1.0, 0.8333333333333334, 0.0], ['Cl', 1.0, 0.8333333333333334, 0.16666666666666666], ['Na', 1.0, 0.8333333333333334, 0.3333333333333333], ['Cl', 1.0, 0.8333333333333334, 0.5], ['Na', 1.0, 0.8333333333333334, 0.6666666666666666], ['Cl', 1.0, 0.8333333333333334, 0.8333333333333334], ['Na', 1.0, 0.8333333333333334, 1.0], ['Cl', 1.0, 1.0, 0.0], ['Na', 1.0, 1.0, 0.16666666666666666], ['Cl', 1.0, 1.0, 0.3333333333333333], ['Na', 1.0, 1.0, 0.5], ['Cl', 1.0, 1.0, 0.6666666666666666], ['Na', 1.0, 1.0, 0.8333333333333334], ['Cl', 1.0, 1.0, 1.0]]

substance_id = 777

res = get_lattice_vectors2(a)

kde_arrays = {}

for ion_key, distances in res.items():
    kde_arr = kde_array(dict(Counter(distances)))
    kde_arrays[ion_key] = kde_arr
    print(f"Ион {ion_key}: KDE shape = {kde_arr.shape}")