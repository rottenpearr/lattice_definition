from scripts.operations.lattice_microoperations import get_lattice_vectors2
from scripts.operations.spectrum_operations import kde_array
from collections import Counter
import numpy as np

a = [['Cl', 0.0, 0.0, 0.0], ['Na', 0.0, 0.0, 0.16666666666666666], ['Cl', 0.0, 0.0, 0.3333333333333333], ['Na', 0.0, 0.0, 0.5], ['Cl', 0.0, 0.0, 0.6666666666666666], ['Na', 0.0, 0.0, 0.8333333333333334], ['Cl', 0.0, 0.0, 1.0], ['Na', 0.0, 0.16666666666666666, 0.0], ['Cl', 0.0, 0.16666666666666666, 0.16666666666666666], ['Na', 0.0, 0.16666666666666666, 0.3333333333333333], ['Cl', 0.0, 0.16666666666666666, 0.5], ['Na', 0.0, 0.16666666666666666, 0.6666666666666666], ['Cl', 0.0, 0.16666666666666666, 0.8333333333333334], ['Na', 0.0, 0.16666666666666666, 1.0], ['Cl', 0.0, 0.3333333333333333, 0.0], ['Na', 0.0, 0.3333333333333333, 0.16666666666666666], ['Cl', 0.0, 0.3333333333333333, 0.3333333333333333], ['Na', 0.0, 0.3333333333333333, 0.5], ['Cl', 0.0, 0.3333333333333333, 0.6666666666666666], ['Na', 0.0, 0.3333333333333333, 0.8333333333333334], ['Cl', 0.0, 0.3333333333333333, 1.0], ['Na', 0.0, 0.5, 0.0], ['Cl', 0.0, 0.5, 0.16666666666666666], ['Na', 0.0, 0.5, 0.3333333333333333], ['Cl', 0.0, 0.5, 0.5], ['Na', 0.0, 0.5, 0.6666666666666666], ['Cl', 0.0, 0.5, 0.8333333333333334], ['Na', 0.0, 0.5, 1.0], ['Cl', 0.0, 0.6666666666666666, 0.0], ['Na', 0.0, 0.6666666666666666, 0.16666666666666666], ['Cl', 0.0, 0.6666666666666666, 0.3333333333333333], ['Na', 0.0, 0.6666666666666666, 0.5], ['Cl', 0.0, 0.6666666666666666, 0.6666666666666666], ['Na', 0.0, 0.6666666666666666, 0.8333333333333334], ['Cl', 0.0, 0.6666666666666666, 1.0], ['Na', 0.0, 0.8333333333333334, 0.0], ['Cl', 0.0, 0.8333333333333334, 0.16666666666666666], ['Na', 0.0, 0.8333333333333334, 0.3333333333333333], ['Cl', 0.0, 0.8333333333333334, 0.5], ['Na', 0.0, 0.8333333333333334, 0.6666666666666666], ['Cl', 0.0, 0.8333333333333334, 0.8333333333333334], ['Na', 0.0, 0.8333333333333334, 1.0], ['Cl', 0.0, 1.0, 0.0], ['Na', 0.0, 1.0, 0.16666666666666666], ['Cl', 0.0, 1.0, 0.3333333333333333], ['Na', 0.0, 1.0, 0.5], ['Cl', 0.0, 1.0, 0.6666666666666666], ['Na', 0.0, 1.0, 0.8333333333333334], ['Cl', 0.0, 1.0, 1.0], ['Na', 0.16666666666666666, 0.0, 0.0], ['Cl', 0.16666666666666666, 0.0, 0.16666666666666666], ['Na', 0.16666666666666666, 0.0, 0.3333333333333333], ['Cl', 0.16666666666666666, 0.0, 0.5], ['Na', 0.16666666666666666, 0.0, 0.6666666666666666], ['Cl', 0.16666666666666666, 0.0, 0.8333333333333334], ['Na', 0.16666666666666666, 0.0, 1.0], ['Cl', 0.16666666666666666, 0.16666666666666666, 0.0], ['Na', 0.16666666666666666, 0.16666666666666666, 0.16666666666666666], ['Cl', 0.16666666666666666, 0.16666666666666666, 0.3333333333333333], ['Na', 0.16666666666666666, 0.16666666666666666, 0.5], ['Cl', 0.16666666666666666, 0.16666666666666666, 0.6666666666666666], ['Na', 0.16666666666666666, 0.16666666666666666, 0.8333333333333334], ['Cl', 0.16666666666666666, 0.16666666666666666, 1.0], ['Na', 0.16666666666666666, 0.3333333333333333, 0.0], ['Cl', 0.16666666666666666, 0.3333333333333333, 0.16666666666666666], ['Na', 0.16666666666666666, 0.3333333333333333, 0.3333333333333333], ['Cl', 0.16666666666666666, 0.3333333333333333, 0.5], ['Na', 0.16666666666666666, 0.3333333333333333, 0.6666666666666666], ['Cl', 0.16666666666666666, 0.3333333333333333, 0.8333333333333334], ['Na', 0.16666666666666666, 0.3333333333333333, 1.0], ['Cl', 0.16666666666666666, 0.5, 0.0], ['Na', 0.16666666666666666, 0.5, 0.16666666666666666], ['Cl', 0.16666666666666666, 0.5, 0.3333333333333333], ['Na', 0.16666666666666666, 0.5, 0.5], ['Cl', 0.16666666666666666, 0.5, 0.6666666666666666], ['Na', 0.16666666666666666, 0.5, 0.8333333333333334], ['Cl', 0.16666666666666666, 0.5, 1.0], ['Na', 0.16666666666666666, 0.6666666666666666, 0.0], ['Cl', 0.16666666666666666, 0.6666666666666666, 0.16666666666666666], ['Na', 0.16666666666666666, 0.6666666666666666, 0.3333333333333333], ['Cl', 0.16666666666666666, 0.6666666666666666, 0.5], ['Na', 0.16666666666666666, 0.6666666666666666, 0.6666666666666666], ['Cl', 0.16666666666666666, 0.6666666666666666, 0.8333333333333334], ['Na', 0.16666666666666666, 0.6666666666666666, 1.0], ['Cl', 0.16666666666666666, 0.8333333333333334, 0.0], ['Na', 0.16666666666666666, 0.8333333333333334, 0.16666666666666666], ['Cl', 0.16666666666666666, 0.8333333333333334, 0.3333333333333333], ['Na', 0.16666666666666666, 0.8333333333333334, 0.5], ['Cl', 0.16666666666666666, 0.8333333333333334, 0.6666666666666666], ['Na', 0.16666666666666666, 0.8333333333333334, 0.8333333333333334], ['Cl', 0.16666666666666666, 0.8333333333333334, 1.0], ['Na', 0.16666666666666666, 1.0, 0.0], ['Cl', 0.16666666666666666, 1.0, 0.16666666666666666], ['Na', 0.16666666666666666, 1.0, 0.3333333333333333], ['Cl', 0.16666666666666666, 1.0, 0.5], ['Na', 0.16666666666666666, 1.0, 0.6666666666666666], ['Cl', 0.16666666666666666, 1.0, 0.8333333333333334], ['Na', 0.16666666666666666, 1.0, 1.0], ['Cl', 0.3333333333333333, 0.0, 0.0], ['Na', 0.3333333333333333, 0.0, 0.16666666666666666], ['Cl', 0.3333333333333333, 0.0, 0.3333333333333333], ['Na', 0.3333333333333333, 0.0, 0.5], ['Cl', 0.3333333333333333, 0.0, 0.6666666666666666], ['Na', 0.3333333333333333, 0.0, 0.8333333333333334], ['Cl', 0.3333333333333333, 0.0, 1.0], ['Na', 0.3333333333333333, 0.16666666666666666, 0.0], ['Cl', 0.3333333333333333, 0.16666666666666666, 0.16666666666666666], ['Na', 0.3333333333333333, 0.16666666666666666, 0.3333333333333333], ['Cl', 0.3333333333333333, 0.16666666666666666, 0.5], ['Na', 0.3333333333333333, 0.16666666666666666, 0.6666666666666666], ['Cl', 0.3333333333333333, 0.16666666666666666, 0.8333333333333334], ['Na', 0.3333333333333333, 0.16666666666666666, 1.0], ['Cl', 0.3333333333333333, 0.3333333333333333, 0.0], ['Na', 0.3333333333333333, 0.3333333333333333, 0.16666666666666666], ['Cl', 0.3333333333333333, 0.3333333333333333, 0.3333333333333333], ['Na', 0.3333333333333333, 0.3333333333333333, 0.5], ['Cl', 0.3333333333333333, 0.3333333333333333, 0.6666666666666666], ['Na', 0.3333333333333333, 0.3333333333333333, 0.8333333333333334], ['Cl', 0.3333333333333333, 0.3333333333333333, 1.0], ['Na', 0.3333333333333333, 0.5, 0.0], ['Cl', 0.3333333333333333, 0.5, 0.16666666666666666], ['Na', 0.3333333333333333, 0.5, 0.3333333333333333], ['Cl', 0.3333333333333333, 0.5, 0.5], ['Na', 0.3333333333333333, 0.5, 0.6666666666666666], ['Cl', 0.3333333333333333, 0.5, 0.8333333333333334], ['Na', 0.3333333333333333, 0.5, 1.0], ['Cl', 0.3333333333333333, 0.6666666666666666, 0.0], ['Na', 0.3333333333333333, 0.6666666666666666, 0.16666666666666666], ['Cl', 0.3333333333333333, 0.6666666666666666, 0.3333333333333333], ['Na', 0.3333333333333333, 0.6666666666666666, 0.5], ['Cl', 0.3333333333333333, 0.6666666666666666, 0.6666666666666666], ['Na', 0.3333333333333333, 0.6666666666666666, 0.8333333333333334], ['Cl', 0.3333333333333333, 0.6666666666666666, 1.0], ['Na', 0.3333333333333333, 0.8333333333333334, 0.0], ['Cl', 0.3333333333333333, 0.8333333333333334, 0.16666666666666666], ['Na', 0.3333333333333333, 0.8333333333333334, 0.3333333333333333], ['Cl', 0.3333333333333333, 0.8333333333333334, 0.5], ['Na', 0.3333333333333333, 0.8333333333333334, 0.6666666666666666], ['Cl', 0.3333333333333333, 0.8333333333333334, 0.8333333333333334], ['Na', 0.3333333333333333, 0.8333333333333334, 1.0], ['Cl', 0.3333333333333333, 1.0, 0.0], ['Na', 0.3333333333333333, 1.0, 0.16666666666666666], ['Cl', 0.3333333333333333, 1.0, 0.3333333333333333], ['Na', 0.3333333333333333, 1.0, 0.5], ['Cl', 0.3333333333333333, 1.0, 0.6666666666666666], ['Na', 0.3333333333333333, 1.0, 0.8333333333333334], ['Cl', 0.3333333333333333, 1.0, 1.0], ['Na', 0.5, 0.0, 0.0], ['Cl', 0.5, 0.0, 0.16666666666666666], ['Na', 0.5, 0.0, 0.3333333333333333], ['Cl', 0.5, 0.0, 0.5], ['Na', 0.5, 0.0, 0.6666666666666666], ['Cl', 0.5, 0.0, 0.8333333333333334], ['Na', 0.5, 0.0, 1.0], ['Cl', 0.5, 0.16666666666666666, 0.0], ['Na', 0.5, 0.16666666666666666, 0.16666666666666666], ['Cl', 0.5, 0.16666666666666666, 0.3333333333333333], ['Na', 0.5, 0.16666666666666666, 0.5], ['Cl', 0.5, 0.16666666666666666, 0.6666666666666666], ['Na', 0.5, 0.16666666666666666, 0.8333333333333334], ['Cl', 0.5, 0.16666666666666666, 1.0], ['Na', 0.5, 0.3333333333333333, 0.0], ['Cl', 0.5, 0.3333333333333333, 0.16666666666666666], ['Na', 0.5, 0.3333333333333333, 0.3333333333333333], ['Cl', 0.5, 0.3333333333333333, 0.5], ['Na', 0.5, 0.3333333333333333, 0.6666666666666666], ['Cl', 0.5, 0.3333333333333333, 0.8333333333333334], ['Na', 0.5, 0.3333333333333333, 1.0], ['Cl', 0.5, 0.5, 0.0], ['Na', 0.5, 0.5, 0.16666666666666666], ['Cl', 0.5, 0.5, 0.3333333333333333], ['Na', 0.5, 0.5, 0.5], ['Cl', 0.5, 0.5, 0.6666666666666666], ['Na', 0.5, 0.5, 0.8333333333333334], ['Cl', 0.5, 0.5, 1.0], ['Na', 0.5, 0.6666666666666666, 0.0], ['Cl', 0.5, 0.6666666666666666, 0.16666666666666666], ['Na', 0.5, 0.6666666666666666, 0.3333333333333333], ['Cl', 0.5, 0.6666666666666666, 0.5], ['Na', 0.5, 0.6666666666666666, 0.6666666666666666], ['Cl', 0.5, 0.6666666666666666, 0.8333333333333334], ['Na', 0.5, 0.6666666666666666, 1.0], ['Cl', 0.5, 0.8333333333333334, 0.0], ['Na', 0.5, 0.8333333333333334, 0.16666666666666666], ['Cl', 0.5, 0.8333333333333334, 0.3333333333333333], ['Na', 0.5, 0.8333333333333334, 0.5], ['Cl', 0.5, 0.8333333333333334, 0.6666666666666666], ['Na', 0.5, 0.8333333333333334, 0.8333333333333334], ['Cl', 0.5, 0.8333333333333334, 1.0], ['Na', 0.5, 1.0, 0.0], ['Cl', 0.5, 1.0, 0.16666666666666666], ['Na', 0.5, 1.0, 0.3333333333333333], ['Cl', 0.5, 1.0, 0.5], ['Na', 0.5, 1.0, 0.6666666666666666], ['Cl', 0.5, 1.0, 0.8333333333333334], ['Na', 0.5, 1.0, 1.0], ['Cl', 0.6666666666666666, 0.0, 0.0], ['Na', 0.6666666666666666, 0.0, 0.16666666666666666], ['Cl', 0.6666666666666666, 0.0, 0.3333333333333333], ['Na', 0.6666666666666666, 0.0, 0.5], ['Cl', 0.6666666666666666, 0.0, 0.6666666666666666], ['Na', 0.6666666666666666, 0.0, 0.8333333333333334], ['Cl', 0.6666666666666666, 0.0, 1.0], ['Na', 0.6666666666666666, 0.16666666666666666, 0.0], ['Cl', 0.6666666666666666, 0.16666666666666666, 0.16666666666666666], ['Na', 0.6666666666666666, 0.16666666666666666, 0.3333333333333333], ['Cl', 0.6666666666666666, 0.16666666666666666, 0.5], ['Na', 0.6666666666666666, 0.16666666666666666, 0.6666666666666666], ['Cl', 0.6666666666666666, 0.16666666666666666, 0.8333333333333334], ['Na', 0.6666666666666666, 0.16666666666666666, 1.0], ['Cl', 0.6666666666666666, 0.3333333333333333, 0.0], ['Na', 0.6666666666666666, 0.3333333333333333, 0.16666666666666666], ['Cl', 0.6666666666666666, 0.3333333333333333, 0.3333333333333333], ['Na', 0.6666666666666666, 0.3333333333333333, 0.5], ['Cl', 0.6666666666666666, 0.3333333333333333, 0.6666666666666666], ['Na', 0.6666666666666666, 0.3333333333333333, 0.8333333333333334], ['Cl', 0.6666666666666666, 0.3333333333333333, 1.0], ['Na', 0.6666666666666666, 0.5, 0.0], ['Cl', 0.6666666666666666, 0.5, 0.16666666666666666], ['Na', 0.6666666666666666, 0.5, 0.3333333333333333], ['Cl', 0.6666666666666666, 0.5, 0.5], ['Na', 0.6666666666666666, 0.5, 0.6666666666666666], ['Cl', 0.6666666666666666, 0.5, 0.8333333333333334], ['Na', 0.6666666666666666, 0.5, 1.0], ['Cl', 0.6666666666666666, 0.6666666666666666, 0.0], ['Na', 0.6666666666666666, 0.6666666666666666, 0.16666666666666666], ['Cl', 0.6666666666666666, 0.6666666666666666, 0.3333333333333333], ['Na', 0.6666666666666666, 0.6666666666666666, 0.5], ['Cl', 0.6666666666666666, 0.6666666666666666, 0.6666666666666666], ['Na', 0.6666666666666666, 0.6666666666666666, 0.8333333333333334], ['Cl', 0.6666666666666666, 0.6666666666666666, 1.0], ['Na', 0.6666666666666666, 0.8333333333333334, 0.0], ['Cl', 0.6666666666666666, 0.8333333333333334, 0.16666666666666666], ['Na', 0.6666666666666666, 0.8333333333333334, 0.3333333333333333], ['Cl', 0.6666666666666666, 0.8333333333333334, 0.5], ['Na', 0.6666666666666666, 0.8333333333333334, 0.6666666666666666], ['Cl', 0.6666666666666666, 0.8333333333333334, 0.8333333333333334], ['Na', 0.6666666666666666, 0.8333333333333334, 1.0], ['Cl', 0.6666666666666666, 1.0, 0.0], ['Na', 0.6666666666666666, 1.0, 0.16666666666666666], ['Cl', 0.6666666666666666, 1.0, 0.3333333333333333], ['Na', 0.6666666666666666, 1.0, 0.5], ['Cl', 0.6666666666666666, 1.0, 0.6666666666666666], ['Na', 0.6666666666666666, 1.0, 0.8333333333333334], ['Cl', 0.6666666666666666, 1.0, 1.0], ['Na', 0.8333333333333334, 0.0, 0.0], ['Cl', 0.8333333333333334, 0.0, 0.16666666666666666], ['Na', 0.8333333333333334, 0.0, 0.3333333333333333], ['Cl', 0.8333333333333334, 0.0, 0.5], ['Na', 0.8333333333333334, 0.0, 0.6666666666666666], ['Cl', 0.8333333333333334, 0.0, 0.8333333333333334], ['Na', 0.8333333333333334, 0.0, 1.0], ['Cl', 0.8333333333333334, 0.16666666666666666, 0.0], ['Na', 0.8333333333333334, 0.16666666666666666, 0.16666666666666666], ['Cl', 0.8333333333333334, 0.16666666666666666, 0.3333333333333333], ['Na', 0.8333333333333334, 0.16666666666666666, 0.5], ['Cl', 0.8333333333333334, 0.16666666666666666, 0.6666666666666666], ['Na', 0.8333333333333334, 0.16666666666666666, 0.8333333333333334], ['Cl', 0.8333333333333334, 0.16666666666666666, 1.0], ['Na', 0.8333333333333334, 0.3333333333333333, 0.0], ['Cl', 0.8333333333333334, 0.3333333333333333, 0.16666666666666666], ['Na', 0.8333333333333334, 0.3333333333333333, 0.3333333333333333], ['Cl', 0.8333333333333334, 0.3333333333333333, 0.5], ['Na', 0.8333333333333334, 0.3333333333333333, 0.6666666666666666], ['Cl', 0.8333333333333334, 0.3333333333333333, 0.8333333333333334], ['Na', 0.8333333333333334, 0.3333333333333333, 1.0], ['Cl', 0.8333333333333334, 0.5, 0.0], ['Na', 0.8333333333333334, 0.5, 0.16666666666666666], ['Cl', 0.8333333333333334, 0.5, 0.3333333333333333], ['Na', 0.8333333333333334, 0.5, 0.5], ['Cl', 0.8333333333333334, 0.5, 0.6666666666666666], ['Na', 0.8333333333333334, 0.5, 0.8333333333333334], ['Cl', 0.8333333333333334, 0.5, 1.0], ['Na', 0.8333333333333334, 0.6666666666666666, 0.0], ['Cl', 0.8333333333333334, 0.6666666666666666, 0.16666666666666666], ['Na', 0.8333333333333334, 0.6666666666666666, 0.3333333333333333], ['Cl', 0.8333333333333334, 0.6666666666666666, 0.5], ['Na', 0.8333333333333334, 0.6666666666666666, 0.6666666666666666], ['Cl', 0.8333333333333334, 0.6666666666666666, 0.8333333333333334], ['Na', 0.8333333333333334, 0.6666666666666666, 1.0], ['Cl', 0.8333333333333334, 0.8333333333333334, 0.0], ['Na', 0.8333333333333334, 0.8333333333333334, 0.16666666666666666], ['Cl', 0.8333333333333334, 0.8333333333333334, 0.3333333333333333], ['Na', 0.8333333333333334, 0.8333333333333334, 0.5], ['Cl', 0.8333333333333334, 0.8333333333333334, 0.6666666666666666], ['Na', 0.8333333333333334, 0.8333333333333334, 0.8333333333333334], ['Cl', 0.8333333333333334, 0.8333333333333334, 1.0], ['Na', 0.8333333333333334, 1.0, 0.0], ['Cl', 0.8333333333333334, 1.0, 0.16666666666666666], ['Na', 0.8333333333333334, 1.0, 0.3333333333333333], ['Cl', 0.8333333333333334, 1.0, 0.5], ['Na', 0.8333333333333334, 1.0, 0.6666666666666666], ['Cl', 0.8333333333333334, 1.0, 0.8333333333333334], ['Na', 0.8333333333333334, 1.0, 1.0], ['Cl', 1.0, 0.0, 0.0], ['Na', 1.0, 0.0, 0.16666666666666666], ['Cl', 1.0, 0.0, 0.3333333333333333], ['Na', 1.0, 0.0, 0.5], ['Cl', 1.0, 0.0, 0.6666666666666666], ['Na', 1.0, 0.0, 0.8333333333333334], ['Cl', 1.0, 0.0, 1.0], ['Na', 1.0, 0.16666666666666666, 0.0], ['Cl', 1.0, 0.16666666666666666, 0.16666666666666666], ['Na', 1.0, 0.16666666666666666, 0.3333333333333333], ['Cl', 1.0, 0.16666666666666666, 0.5], ['Na', 1.0, 0.16666666666666666, 0.6666666666666666], ['Cl', 1.0, 0.16666666666666666, 0.8333333333333334], ['Na', 1.0, 0.16666666666666666, 1.0], ['Cl', 1.0, 0.3333333333333333, 0.0], ['Na', 1.0, 0.3333333333333333, 0.16666666666666666], ['Cl', 1.0, 0.3333333333333333, 0.3333333333333333], ['Na', 1.0, 0.3333333333333333, 0.5], ['Cl', 1.0, 0.3333333333333333, 0.6666666666666666], ['Na', 1.0, 0.3333333333333333, 0.8333333333333334], ['Cl', 1.0, 0.3333333333333333, 1.0], ['Na', 1.0, 0.5, 0.0], ['Cl', 1.0, 0.5, 0.16666666666666666], ['Na', 1.0, 0.5, 0.3333333333333333], ['Cl', 1.0, 0.5, 0.5], ['Na', 1.0, 0.5, 0.6666666666666666], ['Cl', 1.0, 0.5, 0.8333333333333334], ['Na', 1.0, 0.5, 1.0], ['Cl', 1.0, 0.6666666666666666, 0.0], ['Na', 1.0, 0.6666666666666666, 0.16666666666666666], ['Cl', 1.0, 0.6666666666666666, 0.3333333333333333], ['Na', 1.0, 0.6666666666666666, 0.5], ['Cl', 1.0, 0.6666666666666666, 0.6666666666666666], ['Na', 1.0, 0.6666666666666666, 0.8333333333333334], ['Cl', 1.0, 0.6666666666666666, 1.0], ['Na', 1.0, 0.8333333333333334, 0.0], ['Cl', 1.0, 0.8333333333333334, 0.16666666666666666], ['Na', 1.0, 0.8333333333333334, 0.3333333333333333], ['Cl', 1.0, 0.8333333333333334, 0.5], ['Na', 1.0, 0.8333333333333334, 0.6666666666666666], ['Cl', 1.0, 0.8333333333333334, 0.8333333333333334], ['Na', 1.0, 0.8333333333333334, 1.0], ['Cl', 1.0, 1.0, 0.0], ['Na', 1.0, 1.0, 0.16666666666666666], ['Cl', 1.0, 1.0, 0.3333333333333333], ['Na', 1.0, 1.0, 0.5], ['Cl', 1.0, 1.0, 0.6666666666666666], ['Na', 1.0, 1.0, 0.8333333333333334], ['Cl', 1.0, 1.0, 1.0]]
a1 = [['Cl', 0.033333333, 0.0, 0.33333], ['Na', 0.0, 0.0, 0.16666666666666666], ['Cl', 0.0, 0.0, 0.3333333333333333], ['Na', 0.0, 0.0, 0.5], ['Cl', 0.0, 0.0, 0.6666666666666666], ['Na', 0.0, 0.0, 0.8333333333333334], ['Cl', 0.0, 0.0, 1.0], ['Na', 0.0, 0.16666666666666666, 0.0], ['Cl', 0.0, 0.16666666666666666, 0.16666666666666666], ['Na', 0.0, 0.16666666666666666, 0.3333333333333333], ['Cl', 0.0, 0.16666666666666666, 0.5], ['Na', 0.0, 0.16666666666666666, 0.6666666666666666], ['Cl', 0.0, 0.16666666666666666, 0.8333333333333334], ['Na', 0.0, 0.16666666666666666, 1.0], ['Cl', 0.0, 0.3333333333333333, 0.0], ['Na', 0.0, 0.3333333333333333, 0.16666666666666666], ['Cl', 0.0, 0.3333333333333333, 0.3333333333333333], ['Na', 0.0, 0.3333333333333333, 0.5], ['Cl', 0.0, 0.3333333333333333, 0.6666666666666666], ['Na', 0.0, 0.3333333333333333, 0.8333333333333334], ['Cl', 0.0, 0.3333333333333333, 1.0], ['Na', 0.0, 0.5, 0.0], ['Cl', 0.0, 0.5, 0.16666666666666666], ['Na', 0.0, 0.5, 0.3333333333333333], ['Cl', 0.0, 0.5, 0.5], ['Na', 0.0, 0.5, 0.6666666666666666], ['Cl', 0.0, 0.5, 0.8333333333333334], ['Na', 0.0, 0.5, 1.0], ['Cl', 0.0, 0.6666666666666666, 0.0], ['Na', 0.0, 0.6666666666666666, 0.16666666666666666], ['Cl', 0.0, 0.6666666666666666, 0.3333333333333333], ['Na', 0.0, 0.6666666666666666, 0.5], ['Cl', 0.0, 0.6666666666666666, 0.6666666666666666], ['Na', 0.0, 0.6666666666666666, 0.8333333333333334], ['Cl', 0.0, 0.6666666666666666, 1.0], ['Na', 0.0, 0.8333333333333334, 0.0], ['Cl', 0.0, 0.8333333333333334, 0.16666666666666666], ['Na', 0.0, 0.8333333333333334, 0.3333333333333333], ['Cl', 0.0, 0.8333333333333334, 0.5], ['Na', 0.0, 0.8333333333333334, 0.6666666666666666], ['Cl', 0.0, 0.8333333333333334, 0.8333333333333334], ['Na', 0.0, 0.8333333333333334, 1.0], ['Cl', 0.0, 1.0, 0.0], ['Na', 0.0, 1.0, 0.16666666666666666], ['Cl', 0.0, 1.0, 0.3333333333333333], ['Na', 0.0, 1.0, 0.5], ['Cl', 0.0, 1.0, 0.6666666666666666], ['Na', 0.0, 1.0, 0.8333333333333334], ['Cl', 0.0, 1.0, 1.0], ['Na', 0.16666666666666666, 0.0, 0.0], ['Cl', 0.16666666666666666, 0.0, 0.16666666666666666], ['Na', 0.16666666666666666, 0.0, 0.3333333333333333], ['Cl', 0.16666666666666666, 0.0, 0.5], ['Na', 0.16666666666666666, 0.0, 0.6666666666666666], ['Cl', 0.16666666666666666, 0.0, 0.8333333333333334], ['Na', 0.16666666666666666, 0.0, 1.0], ['Cl', 0.16666666666666666, 0.16666666666666666, 0.0], ['Na', 0.16666666666666666, 0.16666666666666666, 0.16666666666666666], ['Cl', 0.16666666666666666, 0.16666666666666666, 0.3333333333333333], ['Na', 0.16666666666666666, 0.16666666666666666, 0.5], ['Cl', 0.16666666666666666, 0.16666666666666666, 0.6666666666666666], ['Na', 0.16666666666666666, 0.16666666666666666, 0.8333333333333334], ['Cl', 0.16666666666666666, 0.16666666666666666, 1.0], ['Na', 0.16666666666666666, 0.3333333333333333, 0.0], ['Cl', 0.16666666666666666, 0.3333333333333333, 0.16666666666666666], ['Na', 0.16666666666666666, 0.3333333333333333, 0.3333333333333333], ['Cl', 0.16666666666666666, 0.3333333333333333, 0.5], ['Na', 0.16666666666666666, 0.3333333333333333, 0.6666666666666666], ['Cl', 0.16666666666666666, 0.3333333333333333, 0.8333333333333334], ['Na', 0.16666666666666666, 0.3333333333333333, 1.0], ['Cl', 0.16666666666666666, 0.5, 0.0], ['Na', 0.16666666666666666, 0.5, 0.16666666666666666], ['Cl', 0.16666666666666666, 0.5, 0.3333333333333333], ['Na', 0.16666666666666666, 0.5, 0.5], ['Cl', 0.16666666666666666, 0.5, 0.6666666666666666], ['Na', 0.16666666666666666, 0.5, 0.8333333333333334], ['Cl', 0.16666666666666666, 0.5, 1.0], ['Na', 0.16666666666666666, 0.6666666666666666, 0.0], ['Cl', 0.16666666666666666, 0.6666666666666666, 0.16666666666666666], ['Na', 0.16666666666666666, 0.6666666666666666, 0.3333333333333333], ['Cl', 0.16666666666666666, 0.6666666666666666, 0.5], ['Na', 0.16666666666666666, 0.6666666666666666, 0.6666666666666666], ['Cl', 0.16666666666666666, 0.6666666666666666, 0.8333333333333334], ['Na', 0.16666666666666666, 0.6666666666666666, 1.0], ['Cl', 0.16666666666666666, 0.8333333333333334, 0.0], ['Na', 0.16666666666666666, 0.8333333333333334, 0.16666666666666666], ['Cl', 0.16666666666666666, 0.8333333333333334, 0.3333333333333333], ['Na', 0.16666666666666666, 0.8333333333333334, 0.5], ['Cl', 0.16666666666666666, 0.8333333333333334, 0.6666666666666666], ['Na', 0.16666666666666666, 0.8333333333333334, 0.8333333333333334], ['Cl', 0.16666666666666666, 0.8333333333333334, 1.0], ['Na', 0.16666666666666666, 1.0, 0.0], ['Cl', 0.16666666666666666, 1.0, 0.16666666666666666], ['Na', 0.16666666666666666, 1.0, 0.3333333333333333], ['Cl', 0.16666666666666666, 1.0, 0.5], ['Na', 0.16666666666666666, 1.0, 0.6666666666666666], ['Cl', 0.16666666666666666, 1.0, 0.8333333333333334], ['Na', 0.16666666666666666, 1.0, 1.0], ['Cl', 0.3333333333333333, 0.0, 0.0], ['Na', 0.3333333333333333, 0.0, 0.16666666666666666], ['Cl', 0.3333333333333333, 0.0, 0.3333333333333333], ['Na', 0.3333333333333333, 0.0, 0.5], ['Cl', 0.3333333333333333, 0.0, 0.6666666666666666], ['Na', 0.3333333333333333, 0.0, 0.8333333333333334], ['Cl', 0.3333333333333333, 0.0, 1.0], ['Na', 0.3333333333333333, 0.16666666666666666, 0.0], ['Cl', 0.3333333333333333, 0.16666666666666666, 0.16666666666666666], ['Na', 0.3333333333333333, 0.16666666666666666, 0.3333333333333333], ['Cl', 0.3333333333333333, 0.16666666666666666, 0.5], ['Na', 0.3333333333333333, 0.16666666666666666, 0.6666666666666666], ['Cl', 0.3333333333333333, 0.16666666666666666, 0.8333333333333334], ['Na', 0.3333333333333333, 0.16666666666666666, 1.0], ['Cl', 0.3333333333333333, 0.3333333333333333, 0.0], ['Na', 0.3333333333333333, 0.3333333333333333, 0.16666666666666666], ['Cl', 0.3333333333333333, 0.3333333333333333, 0.3333333333333333], ['Na', 0.3333333333333333, 0.3333333333333333, 0.5], ['Cl', 0.3333333333333333, 0.3333333333333333, 0.6666666666666666], ['Na', 0.3333333333333333, 0.3333333333333333, 0.8333333333333334], ['Cl', 0.3333333333333333, 0.3333333333333333, 1.0], ['Na', 0.3333333333333333, 0.5, 0.0], ['Cl', 0.3333333333333333, 0.5, 0.16666666666666666], ['Na', 0.3333333333333333, 0.5, 0.3333333333333333], ['Cl', 0.3333333333333333, 0.5, 0.5], ['Na', 0.3333333333333333, 0.5, 0.6666666666666666], ['Cl', 0.3333333333333333, 0.5, 0.8333333333333334], ['Na', 0.3333333333333333, 0.5, 1.0], ['Cl', 0.3333333333333333, 0.6666666666666666, 0.0], ['Na', 0.3333333333333333, 0.6666666666666666, 0.16666666666666666], ['Cl', 0.3333333333333333, 0.6666666666666666, 0.3333333333333333], ['Na', 0.3333333333333333, 0.6666666666666666, 0.5], ['Cl', 0.3333333333333333, 0.6666666666666666, 0.6666666666666666], ['Na', 0.3333333333333333, 0.6666666666666666, 0.8333333333333334], ['Cl', 0.3333333333333333, 0.6666666666666666, 1.0], ['Na', 0.3333333333333333, 0.8333333333333334, 0.0], ['Cl', 0.3333333333333333, 0.8333333333333334, 0.16666666666666666], ['Na', 0.3333333333333333, 0.8333333333333334, 0.3333333333333333], ['Cl', 0.3333333333333333, 0.8333333333333334, 0.5], ['Na', 0.3333333333333333, 0.8333333333333334, 0.6666666666666666], ['Cl', 0.3333333333333333, 0.8333333333333334, 0.8333333333333334], ['Na', 0.3333333333333333, 0.8333333333333334, 1.0], ['Cl', 0.3333333333333333, 1.0, 0.0], ['Na', 0.3333333333333333, 1.0, 0.16666666666666666], ['Cl', 0.3333333333333333, 1.0, 0.3333333333333333], ['Na', 0.3333333333333333, 1.0, 0.5], ['Cl', 0.3333333333333333, 1.0, 0.6666666666666666], ['Na', 0.3333333333333333, 1.0, 0.8333333333333334], ['Cl', 0.3333333333333333, 1.0, 1.0], ['Na', 0.5, 0.0, 0.0], ['Cl', 0.5, 0.0, 0.16666666666666666], ['Na', 0.5, 0.0, 0.3333333333333333], ['Cl', 0.5, 0.0, 0.5], ['Na', 0.5, 0.0, 0.6666666666666666], ['Cl', 0.5, 0.0, 0.8333333333333334], ['Na', 0.5, 0.0, 1.0], ['Cl', 0.5, 0.16666666666666666, 0.0], ['Na', 0.5, 0.16666666666666666, 0.16666666666666666], ['Cl', 0.5, 0.16666666666666666, 0.3333333333333333], ['Na', 0.5, 0.16666666666666666, 0.5], ['Cl', 0.5, 0.16666666666666666, 0.6666666666666666], ['Na', 0.5, 0.16666666666666666, 0.8333333333333334], ['Cl', 0.5, 0.16666666666666666, 1.0], ['Na', 0.5, 0.3333333333333333, 0.0], ['Cl', 0.5, 0.3333333333333333, 0.16666666666666666], ['Na', 0.5, 0.3333333333333333, 0.3333333333333333], ['Cl', 0.5, 0.3333333333333333, 0.5], ['Na', 0.5, 0.3333333333333333, 0.6666666666666666], ['Cl', 0.5, 0.3333333333333333, 0.8333333333333334], ['Na', 0.5, 0.3333333333333333, 1.0], ['Cl', 0.5, 0.5, 0.0], ['Na', 0.5, 0.5, 0.16666666666666666], ['Cl', 0.5, 0.5, 0.3333333333333333], ['Na', 0.5, 0.5, 0.5], ['Cl', 0.5, 0.5, 0.6666666666666666], ['Na', 0.5, 0.5, 0.8333333333333334], ['Cl', 0.5, 0.5, 1.0], ['Na', 0.5, 0.6666666666666666, 0.0], ['Cl', 0.5, 0.6666666666666666, 0.16666666666666666], ['Na', 0.5, 0.6666666666666666, 0.3333333333333333], ['Cl', 0.5, 0.6666666666666666, 0.5], ['Na', 0.5, 0.6666666666666666, 0.6666666666666666], ['Cl', 0.5, 0.6666666666666666, 0.8333333333333334], ['Na', 0.5, 0.6666666666666666, 1.0], ['Cl', 0.5, 0.8333333333333334, 0.0], ['Na', 0.5, 0.8333333333333334, 0.16666666666666666], ['Cl', 0.5, 0.8333333333333334, 0.3333333333333333], ['Na', 0.5, 0.8333333333333334, 0.5], ['Cl', 0.5, 0.8333333333333334, 0.6666666666666666], ['Na', 0.5, 0.8333333333333334, 0.8333333333333334], ['Cl', 0.5, 0.8333333333333334, 1.0], ['Na', 0.5, 1.0, 0.0], ['Cl', 0.5, 1.0, 0.16666666666666666], ['Na', 0.5, 1.0, 0.3333333333333333], ['Cl', 0.5, 1.0, 0.5], ['Na', 0.5, 1.0, 0.6666666666666666], ['Cl', 0.5, 1.0, 0.8333333333333334], ['Na', 0.5, 1.0, 1.0], ['Cl', 0.6666666666666666, 0.0, 0.0], ['Na', 0.6666666666666666, 0.0, 0.16666666666666666], ['Cl', 0.6666666666666666, 0.0, 0.3333333333333333], ['Na', 0.6666666666666666, 0.0, 0.5], ['Cl', 0.6666666666666666, 0.0, 0.6666666666666666], ['Na', 0.6666666666666666, 0.0, 0.8333333333333334], ['Cl', 0.6666666666666666, 0.0, 1.0], ['Na', 0.6666666666666666, 0.16666666666666666, 0.0], ['Cl', 0.6666666666666666, 0.16666666666666666, 0.16666666666666666], ['Na', 0.6666666666666666, 0.16666666666666666, 0.3333333333333333], ['Cl', 0.6666666666666666, 0.16666666666666666, 0.5], ['Na', 0.6666666666666666, 0.16666666666666666, 0.6666666666666666], ['Cl', 0.6666666666666666, 0.16666666666666666, 0.8333333333333334], ['Na', 0.6666666666666666, 0.16666666666666666, 1.0], ['Cl', 0.6666666666666666, 0.3333333333333333, 0.0], ['Na', 0.6666666666666666, 0.3333333333333333, 0.16666666666666666], ['Cl', 0.6666666666666666, 0.3333333333333333, 0.3333333333333333], ['Na', 0.6666666666666666, 0.3333333333333333, 0.5], ['Cl', 0.6666666666666666, 0.3333333333333333, 0.6666666666666666], ['Na', 0.6666666666666666, 0.3333333333333333, 0.8333333333333334], ['Cl', 0.6666666666666666, 0.3333333333333333, 1.0], ['Na', 0.6666666666666666, 0.5, 0.0], ['Cl', 0.6666666666666666, 0.5, 0.16666666666666666], ['Na', 0.6666666666666666, 0.5, 0.3333333333333333], ['Cl', 0.6666666666666666, 0.5, 0.5], ['Na', 0.6666666666666666, 0.5, 0.6666666666666666], ['Cl', 0.6666666666666666, 0.5, 0.8333333333333334], ['Na', 0.6666666666666666, 0.5, 1.0], ['Cl', 0.6666666666666666, 0.6666666666666666, 0.0], ['Na', 0.6666666666666666, 0.6666666666666666, 0.16666666666666666], ['Cl', 0.6666666666666666, 0.6666666666666666, 0.3333333333333333], ['Na', 0.6666666666666666, 0.6666666666666666, 0.5], ['Cl', 0.6666666666666666, 0.6666666666666666, 0.6666666666666666], ['Na', 0.6666666666666666, 0.6666666666666666, 0.8333333333333334], ['Cl', 0.6666666666666666, 0.6666666666666666, 1.0], ['Na', 0.6666666666666666, 0.8333333333333334, 0.0], ['Cl', 0.6666666666666666, 0.8333333333333334, 0.16666666666666666], ['Na', 0.6666666666666666, 0.8333333333333334, 0.3333333333333333], ['Cl', 0.6666666666666666, 0.8333333333333334, 0.5], ['Na', 0.6666666666666666, 0.8333333333333334, 0.6666666666666666], ['Cl', 0.6666666666666666, 0.8333333333333334, 0.8333333333333334], ['Na', 0.6666666666666666, 0.8333333333333334, 1.0], ['Cl', 0.6666666666666666, 1.0, 0.0], ['Na', 0.6666666666666666, 1.0, 0.16666666666666666], ['Cl', 0.6666666666666666, 1.0, 0.3333333333333333], ['Na', 0.6666666666666666, 1.0, 0.5], ['Cl', 0.6666666666666666, 1.0, 0.6666666666666666], ['Na', 0.6666666666666666, 1.0, 0.8333333333333334], ['Cl', 0.6666666666666666, 1.0, 1.0], ['Na', 0.8333333333333334, 0.0, 0.0], ['Cl', 0.8333333333333334, 0.0, 0.16666666666666666], ['Na', 0.8333333333333334, 0.0, 0.3333333333333333], ['Cl', 0.8333333333333334, 0.0, 0.5], ['Na', 0.8333333333333334, 0.0, 0.6666666666666666], ['Cl', 0.8333333333333334, 0.0, 0.8333333333333334], ['Na', 0.8333333333333334, 0.0, 1.0], ['Cl', 0.8333333333333334, 0.16666666666666666, 0.0], ['Na', 0.8333333333333334, 0.16666666666666666, 0.16666666666666666], ['Cl', 0.8333333333333334, 0.16666666666666666, 0.3333333333333333], ['Na', 0.8333333333333334, 0.16666666666666666, 0.5], ['Cl', 0.8333333333333334, 0.16666666666666666, 0.6666666666666666], ['Na', 0.8333333333333334, 0.16666666666666666, 0.8333333333333334], ['Cl', 0.8333333333333334, 0.16666666666666666, 1.0], ['Na', 0.8333333333333334, 0.3333333333333333, 0.0], ['Cl', 0.8333333333333334, 0.3333333333333333, 0.16666666666666666], ['Na', 0.8333333333333334, 0.3333333333333333, 0.3333333333333333], ['Cl', 0.8333333333333334, 0.3333333333333333, 0.5], ['Na', 0.8333333333333334, 0.3333333333333333, 0.6666666666666666], ['Cl', 0.8333333333333334, 0.3333333333333333, 0.8333333333333334], ['Na', 0.8333333333333334, 0.3333333333333333, 1.0], ['Cl', 0.8333333333333334, 0.5, 0.0], ['Na', 0.8333333333333334, 0.5, 0.16666666666666666], ['Cl', 0.8333333333333334, 0.5, 0.3333333333333333], ['Na', 0.8333333333333334, 0.5, 0.5], ['Cl', 0.8333333333333334, 0.5, 0.6666666666666666], ['Na', 0.8333333333333334, 0.5, 0.8333333333333334], ['Cl', 0.8333333333333334, 0.5, 1.0], ['Na', 0.8333333333333334, 0.6666666666666666, 0.0], ['Cl', 0.8333333333333334, 0.6666666666666666, 0.16666666666666666], ['Na', 0.8333333333333334, 0.6666666666666666, 0.3333333333333333], ['Cl', 0.8333333333333334, 0.6666666666666666, 0.5], ['Na', 0.8333333333333334, 0.6666666666666666, 0.6666666666666666], ['Cl', 0.8333333333333334, 0.6666666666666666, 0.8333333333333334], ['Na', 0.8333333333333334, 0.6666666666666666, 1.0], ['Cl', 0.8333333333333334, 0.8333333333333334, 0.0], ['Na', 0.8333333333333334, 0.8333333333333334, 0.16666666666666666], ['Cl', 0.8333333333333334, 0.8333333333333334, 0.3333333333333333], ['Na', 0.8333333333333334, 0.8333333333333334, 0.5], ['Cl', 0.8333333333333334, 0.8333333333333334, 0.6666666666666666], ['Na', 0.8333333333333334, 0.8333333333333334, 0.8333333333333334], ['Cl', 0.8333333333333334, 0.8333333333333334, 1.0], ['Na', 0.8333333333333334, 1.0, 0.0], ['Cl', 0.8333333333333334, 1.0, 0.16666666666666666], ['Na', 0.8333333333333334, 1.0, 0.3333333333333333], ['Cl', 0.8333333333333334, 1.0, 0.5], ['Na', 0.8333333333333334, 1.0, 0.6666666666666666], ['Cl', 0.8333333333333334, 1.0, 0.8333333333333334], ['Na', 0.8333333333333334, 1.0, 1.0], ['Cl', 1.0, 0.0, 0.0], ['Na', 1.0, 0.0, 0.16666666666666666], ['Cl', 1.0, 0.0, 0.3333333333333333], ['Na', 1.0, 0.0, 0.5], ['Cl', 1.0, 0.0, 0.6666666666666666], ['Na', 1.0, 0.0, 0.8333333333333334], ['Cl', 1.0, 0.0, 1.0], ['Na', 1.0, 0.16666666666666666, 0.0], ['Cl', 1.0, 0.16666666666666666, 0.16666666666666666], ['Na', 1.0, 0.16666666666666666, 0.3333333333333333], ['Cl', 1.0, 0.16666666666666666, 0.5], ['Na', 1.0, 0.16666666666666666, 0.6666666666666666], ['Cl', 1.0, 0.16666666666666666, 0.8333333333333334], ['Na', 1.0, 0.16666666666666666, 1.0], ['Cl', 1.0, 0.3333333333333333, 0.0], ['Na', 1.0, 0.3333333333333333, 0.16666666666666666], ['Cl', 1.0, 0.3333333333333333, 0.3333333333333333], ['Na', 1.0, 0.3333333333333333, 0.5], ['Cl', 1.0, 0.3333333333333333, 0.6666666666666666], ['Na', 1.0, 0.3333333333333333, 0.8333333333333334], ['Cl', 1.0, 0.3333333333333333, 1.0], ['Na', 1.0, 0.5, 0.0], ['Cl', 1.0, 0.5, 0.16666666666666666], ['Na', 1.0, 0.5, 0.3333333333333333], ['Cl', 1.0, 0.5, 0.5], ['Na', 1.0, 0.5, 0.6666666666666666], ['Cl', 1.0, 0.5, 0.8333333333333334], ['Na', 1.0, 0.5, 1.0], ['Cl', 1.0, 0.6666666666666666, 0.0], ['Na', 1.0, 0.6666666666666666, 0.16666666666666666], ['Cl', 1.0, 0.6666666666666666, 0.3333333333333333], ['Na', 1.0, 0.6666666666666666, 0.5], ['Cl', 1.0, 0.6666666666666666, 0.6666666666666666], ['Na', 1.0, 0.6666666666666666, 0.8333333333333334], ['Cl', 1.0, 0.6666666666666666, 1.0], ['Na', 1.0, 0.8333333333333334, 0.0], ['Cl', 1.0, 0.8333333333333334, 0.16666666666666666], ['Na', 1.0, 0.8333333333333334, 0.3333333333333333], ['Cl', 1.0, 0.8333333333333334, 0.5], ['Na', 1.0, 0.8333333333333334, 0.6666666666666666], ['Cl', 1.0, 0.8333333333333334, 0.8333333333333334], ['Na', 1.0, 0.8333333333333334, 1.0], ['Cl', 1.0, 1.0, 0.0], ['Na', 1.0, 1.0, 0.16666666666666666], ['Cl', 1.0, 1.0, 0.3333333333333333], ['Na', 1.0, 1.0, 0.5], ['Cl', 1.0, 1.0, 0.6666666666666666], ['Na', 1.0, 1.0, 0.8333333333333334], ['Cl', 1.0, 1.0, 1.0]]

substance_id = 777

res = get_lattice_vectors2(a)
res_a1 = get_lattice_vectors2(a1)

for id, ion in enumerate(res.keys()):
    a = 1

kde_arr1 = kde_array(dict(Counter(list(res.values())[0])))
kde_arr2 = kde_array(dict(Counter(list(res_a1.values())[0])))
kde_percentages = (kde_arr1 / kde_arr2)

print(np.mean(kde_percentages))